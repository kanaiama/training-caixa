var sjclcrp={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};
"undefined"!=typeof module&&module.exports&&(module.exports=sjclcrp);"function"==typeof define&&define([],function(){return sjclcrp});
sjclcrp.cipher.aes=function(a){this._tables[0][0][0]||this._precompute();var b,c,d=this._tables[0][4],e=this._tables[1];var f=a.length;var g=1;if(4!==f&&6!==f&&8!==f)throw new sjclcrp.exception.invalid("invalid aes key size");this._key=[b=a.slice(0),c=[]];for(a=f;4*f+28>a;a++){var h=b[a-1];(0===a%f||8===f&&4===a%f)&&(h=d[h>>>24]<<24^d[h>>16&255]<<16^d[h>>8&255]<<8^d[255&h],0===a%f&&(h=h<<8^h>>>24^g<<24,g=g<<1^283*(g>>7)));b[a]=b[a-f]^h}for(f=0;a;f++,a--)h=b[3&f?a:a-4],c[f]=4>=a||4>f?h:e[0][d[h>>>
24]]^e[1][d[h>>16&255]]^e[2][d[h>>8&255]]^e[3][d[255&h]]};
sjclcrp.cipher.aes.prototype={encrypt:function(a){return this._crypt(a,0)},decrypt:function(a){return this._crypt(a,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var a,b,c,d,e=this._tables[0],f=this._tables[1],g=e[4],h=f[4],k=[],l=[];for(a=0;256>a;a++)l[(k[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!g[b];b^=d||1,c=l[c]||1){var r=c^c<<1^c<<2^c<<3^c<<4;r=r>>8^255&r^99;g[b]=r;h[r]=b;var q=k[a=k[d=k[b]]];var m=16843009*q^65537*a^257*d^16843008*b;q=257*k[r]^16843008*r;for(a=0;4>a;a++)e[a][b]=
q=q<<24^q>>>8,f[a][r]=m=m<<24^m>>>8}for(a=0;5>a;a++)e[a]=e[a].slice(0),f[a]=f[a].slice(0)},_crypt:function(a,b){if(4!==a.length)throw new sjclcrp.exception.invalid("invalid aes block size");var c,d=this._key[b],e=a[0]^d[0],f=a[b?3:1]^d[1],g=a[2]^d[2],h=a[b?1:3]^d[3],k=d.length/4-2,l=4,r=[0,0,0,0];var q=this._tables[b];var m=q[0],n=q[1],p=q[2],t=q[3],w=q[4];for(c=0;k>c;c++){q=m[e>>>24]^n[f>>16&255]^p[g>>8&255]^t[255&h]^d[l];var z=m[f>>>24]^n[g>>16&255]^p[h>>8&255]^t[255&e]^d[l+1];var C=m[g>>>24]^n[h>>
16&255]^p[e>>8&255]^t[255&f]^d[l+2];h=m[h>>>24]^n[e>>16&255]^p[f>>8&255]^t[255&g]^d[l+3];l+=4;e=q;f=z;g=C}for(c=0;4>c;c++)r[b?3&-c:c]=w[e>>>24]<<24^w[f>>16&255]<<16^w[g>>8&255]<<8^w[255&h]^d[l++],q=e,e=f,f=g,g=h,h=q;return r}};
sjclcrp.bitArray={bitSlice:function(a,b,c){return a=sjclcrp.bitArray._shiftRight(a.slice(b/32),32-(31&b)).slice(1),void 0===c?a:sjclcrp.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d,e=Math.floor(-b-c&31);return d=-32&(b+c-1^b)?a[b/32|0]<<32-e^a[b/32+1|0]>>>e:a[b/32|0]>>>e,d&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjclcrp.bitArray.getPartial(c);return 32===d?a.concat(b):sjclcrp.bitArray._shiftRight(b,d,0|c,a.slice(0,a.length-1))},
bitLength:function(a){var b,c=a.length;return 0===c?0:(b=a[c-1],32*(c-1)+sjclcrp.bitArray.getPartial(b))},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;return b&=31,0<c&&b&&(a[c-1]=sjclcrp.bitArray.partial(b,a[c-1]&2147483648>>b-1,1)),a},partial:function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjclcrp.bitArray.bitLength(a)!==sjclcrp.bitArray.bitLength(b))return!1;
var c,d=0;for(c=0;c<a.length;c++)d|=a[c]^b[c];return 0===d},_shiftRight:function(a,b,c,d){var e,f,g=0;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;return g=a.length?a[a.length-1]:0,f=sjclcrp.bitArray.getPartial(g),d.push(sjclcrp.bitArray.partial(b+f&31,32<b+f?c:d.pop(),1)),d},_xor4:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b;for(b=0;b<a.length;++b){var c=a[b];a[b]=
c>>>24|c>>>8&65280|(c&65280)<<8|c<<24}return a}};sjclcrp.bn=function(a){this.initWith(a)};
sjclcrp.bn.prototype={radix:24,maxMul:8,_class:sjclcrp.bn,copy:function(){return new this._class(this)},initWith:function(a){var b;switch(typeof a){case "object":this.limbs=a.limbs.slice(0);break;case "number":this.limbs=[a];this.normalize();break;case "string":a=a.replace(/^0x/,"");this.limbs=[];var c=this.radix/4;for(b=0;b<a.length;b+=c)this.limbs.push(parseInt(a.substring(Math.max(a.length-b-c,0),a.length-b),16));break;default:this.limbs=[0]}return this},equals:function(a){"number"==typeof a&&
(a=new this._class(a));var b,c=0;this.fullReduce();a.fullReduce();for(b=0;b<this.limbs.length||b<a.limbs.length;b++)c|=this.getLimb(b)^a.getLimb(b);return 0===c},getLimb:function(a){return a>=this.limbs.length?0:this.limbs[a]},greaterEquals:function(a){"number"==typeof a&&(a=new this._class(a));var b,c=0,d=0;for(b=Math.max(this.limbs.length,a.limbs.length)-1;0<=b;b--){var e=this.getLimb(b);var f=a.getLimb(b);d|=f-e&~c;c|=e-f&~d}return(d|~c)>>>31},toString:function(){this.fullReduce();var a,b,c="",
d=this.limbs;for(a=0;a<this.limbs.length;a++){for(b=d[a].toString(16);a<this.limbs.length-1&&6>b.length;)b="0"+b;c=b+c}return"0x"+c},addM:function(a){"object"!=typeof a&&(a=new this._class(a));var b=this.limbs,c=a.limbs;for(a=b.length;a<c.length;a++)b[a]=0;for(a=0;a<c.length;a++)b[a]+=c[a];return this},doubleM:function(){var a,b=0,c=this.radix,d=this.radixMask,e=this.limbs;for(a=0;a<e.length;a++){var f=e[a];f=f+f+b;e[a]=f&d;b=f>>c}return b&&e.push(b),this},halveM:function(){var a,b=0,c=this.radix,
d=this.limbs;for(a=d.length-1;0<=a;a--){var e=d[a];d[a]=e+b>>1;b=(1&e)<<c}return d[d.length-1]||d.pop(),this},subM:function(a){"object"!=typeof a&&(a=new this._class(a));var b=this.limbs,c=a.limbs;for(a=b.length;a<c.length;a++)b[a]=0;for(a=0;a<c.length;a++)b[a]-=c[a];return this},mod:function(a){var b=!this.greaterEquals(new sjclcrp.bn(0));a=(new sjclcrp.bn(a)).normalize();var c=(new sjclcrp.bn(this)).normalize(),d=0;for(b&&(c=(new sjclcrp.bn(0)).subM(c).normalize());c.greaterEquals(a);d++)a.doubleM();
for(b&&(c=a.sub(c).normalize());0<d;d--)a.halveM(),c.greaterEquals(a)&&c.subM(a).normalize();return c.trim()},inverseMod:function(a){var b,c,d=new sjclcrp.bn(1),e=new sjclcrp.bn(0),f=new sjclcrp.bn(this),g=new sjclcrp.bn(a),h;if(!(1&a.limbs[0]))throw new sjclcrp.exception.invalid("inverseMod: p must be odd");do for(1&f.limbs[0]&&(f.greaterEquals(g)||(b=f,f=g,g=b,b=d,d=e,e=b),f.subM(g),f.normalize(),d.greaterEquals(e)||d.addM(a),d.subM(e)),f.halveM(),1&d.limbs[0]&&d.addM(a),d.normalize(),d.halveM(),
c=h=0;c<f.limbs.length;c++)h|=f.limbs[c];while(h);if(!g.equals(1))throw new sjclcrp.exception.invalid("inverseMod: p and x must be relatively prime");return e},add:function(a){return this.copy().addM(a)},sub:function(a){return this.copy().subM(a)},mul:function(a){"number"==typeof a&&(a=new this._class(a));var b,c=this.limbs,d=a.limbs,e=c.length,f=d.length,g=new this._class,h=g.limbs,k=this.maxMul;for(b=0;b<this.limbs.length+a.limbs.length+1;b++)h[b]=0;for(b=0;e>b;b++){var l=c[b];for(a=0;f>a;a++)h[b+
a]+=l*d[a];--k||(k=this.maxMul,g.cnormalize())}return g.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(a){"number"==typeof a?a=[a]:void 0!==a.limbs&&(a=a.normalize().limbs);var b,c,d=new this._class(1),e=this;for(b=0;b<a.length;b++)for(c=0;c<this.radix;c++)a[b]&1<<c&&(d=d.mul(e)),e=e.square();return d},mulmod:function(a,b){return this.mod(b).mul(a.mod(b)).mod(b)},powermod:function(a,b){for(var c=new sjclcrp.bn(1),d=new sjclcrp.bn(this),e=new sjclcrp.bn(a);1&e.limbs[0]&&
(c=c.mulmod(d,b)),e.halveM(),!e.equals(0);)d=d.mulmod(d,b);return c.normalize().reduce()},trim:function(){var a=this.limbs;do var b=a.pop();while(a.length&&0===b);return a.push(b),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var a;var b=0;var c=this.placeVal,d=this.ipv,e=this.limbs,f=e.length,g=this.radixMask;for(a=0;f>a||0!==b&&-1!==b;a++){b=(e[a]||0)+b;var h=e[a]=b&g;b=(b-h)*d}return-1===b&&(e[a-1]-=c),this},cnormalize:function(){var a;
var b=0;var c=this.ipv,d=this.limbs,e=d.length,f=this.radixMask;for(a=0;e-1>a;a++){b=d[a]+b;var g=d[a]=b&f;b=(b-g)*c}return d[a]+=b,this},toBits:function(a){this.fullReduce();a=a||this.exponent||this.bitLength();var b=Math.floor((a-1)/24),c=sjclcrp.bitArray,d=[c.partial((a+7&-8)%this.radix||this.radix,this.getLimb(b))];for(b--;0<=b;b--)d=c.concat(d,[c.partial(Math.min(this.radix,a),this.getLimb(b))]),a-=this.radix;return d},bitLength:function(){this.fullReduce();for(var a=this.radix*(this.limbs.length-
1),b=this.limbs[this.limbs.length-1];b;b>>>=1)a++;return a+7&-8}};sjclcrp.bn.fromBits=function(a){var b=new this,c=[],d=sjclcrp.bitArray,e=this.prototype,f=Math.min(this.bitLength||4294967296,d.bitLength(a)),g=f%e.radix||e.radix;for(c[0]=d.extract(a,0,g);f>g;g+=e.radix)c.unshift(d.extract(a,g,e.radix));return b.limbs=c,b};sjclcrp.bn.prototype.ipv=1/(sjclcrp.bn.prototype.placeVal=Math.pow(2,sjclcrp.bn.prototype.radix));sjclcrp.bn.prototype.radixMask=(1<<sjclcrp.bn.prototype.radix)-1;
sjclcrp.bn.pseudoMersennePrime=function(a,b){function c(g){this.initWith(g)}var d,e=c.prototype=new sjclcrp.bn;var f=e.modOffset=Math.ceil(d=a/e.radix);e.exponent=a;e.offset=[];e.factor=[];e.minOffset=f;e.fullMask=0;e.fullOffset=[];e.fullFactor=[];e.modulus=c.modulus=new sjclcrp.bn(Math.pow(2,a));e.fullMask=0|-Math.pow(2,a%e.radix);for(f=0;f<b.length;f++)e.offset[f]=Math.floor(b[f][0]/e.radix-d),e.fullOffset[f]=Math.ceil(b[f][0]/e.radix-d),e.factor[f]=b[f][1]*Math.pow(.5,a-b[f][0]+e.offset[f]*e.radix),
e.fullFactor[f]=b[f][1]*Math.pow(.5,a-b[f][0]+e.fullOffset[f]*e.radix),e.modulus.addM(new sjclcrp.bn(Math.pow(2,b[f][0])*b[f][1])),e.minOffset=Math.min(e.minOffset,-e.offset[f]);return e._class=c,e.modulus.cnormalize(),e.reduce=function(){var g,h,k=this.modOffset,l=this.limbs,r=this.offset,q=this.offset.length,m=this.factor;for(g=this.minOffset;l.length>k;){var n=l.pop();var p=l.length;for(h=0;q>h;h++)l[p+r[h]]-=m[h]*n;g--;g||(l.push(0),this.cnormalize(),g=this.minOffset)}return this.cnormalize(),
this},e._strongReduce=-1===e.fullMask?e.reduce:function(){var g,h=this.limbs,k=h.length-1;if(this.reduce(),k===this.modOffset-1){var l=h[k]&this.fullMask;h[k]-=l;for(g=0;g<this.fullOffset.length;g++)h[k+this.fullOffset[g]]-=this.fullFactor[g]*l;this.normalize()}},e.fullReduce=function(){var g;this._strongReduce();this.addM(this.modulus);this.addM(this.modulus);this.normalize();this._strongReduce();for(g=this.limbs.length;g<this.modOffset;g++)this.limbs[g]=0;var h=this.greaterEquals(this.modulus);
for(g=0;g<this.limbs.length;g++)this.limbs[g]-=this.modulus.limbs[g]*h;return this.cnormalize(),this},e.inverse=function(){return this.power(this.modulus.sub(2))},c.fromBits=sjclcrp.bn.fromBits,c};var sbp=sjclcrp.bn.pseudoMersennePrime;
sjclcrp.bn.prime={p127:sbp(127,[[0,-1]]),p25519:sbp(255,[[0,-19]]),p192k:sbp(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),p224k:sbp(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:sbp(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:sbp(192,[[0,-1],[64,-1]]),p224:sbp(224,[[0,1],[96,-1]]),p256:sbp(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:sbp(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:sbp(521,[[0,-1]])};
sjclcrp.bn.random=function(a,b){"object"!=typeof a&&(a=new sjclcrp.bn(a));for(var c,d,e=a.limbs.length,f=a.limbs[e-1]+1,g=new sjclcrp.bn;;){do c=sjclcrp.random.randomWords(e,b),0>c[e-1]&&(c[e-1]+=4294967296);while(Math.floor(c[e-1]/f)===Math.floor(4294967296/f));c[e-1]%=f;for(d=0;e-1>d;d++)c[d]&=a.radixMask;if(g.limbs=c,!g.greaterEquals(a))return g}};void 0===sjclcrp.beware&&(sjclcrp.beware={});
sjclcrp.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){sjclcrp.mode.cbc={name:"cbc",encrypt:function(a,b,c,d){if(d&&d.length)throw new sjclcrp.exception.invalid("cbc can't authenticate data");if(128!==sjclcrp.bitArray.bitLength(c))throw new sjclcrp.exception.invalid("cbc iv must be 128 bits");var e=sjclcrp.bitArray,f=e._xor4,g=e.bitLength(b),h=0,k=[];if(7&g)throw new sjclcrp.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(d=0;g>=
h+128;d+=4,h+=128)c=a.encrypt(f(c,b.slice(d,d+4))),k.splice(d,0,c[0],c[1],c[2],c[3]);return g=16843009*(16-(g>>3&15)),c=a.encrypt(f(c,e.concat(b,[g,g,g,g]).slice(d,d+4))),k.splice(d,0,c[0],c[1],c[2],c[3]),k},decrypt:function(a,b,c,d){if(d&&d.length)throw new sjclcrp.exception.invalid("cbc can't authenticate data");if(128!==sjclcrp.bitArray.bitLength(c))throw new sjclcrp.exception.invalid("cbc iv must be 128 bits");if(127&sjclcrp.bitArray.bitLength(b)||!b.length)throw new sjclcrp.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");
var e=sjclcrp.bitArray,f=e._xor4,g=[];for(d=0;d<b.length;d+=4){var h=b.slice(d,d+4);var k=f(c,a.decrypt(h));g.splice(d,0,k[0],k[1],k[2],k[3]);c=h}if(h=255&g[d-1],0===h||16<h)throw new sjclcrp.exception.corrupt("pkcs#5 padding corrupt");if(k=16843009*h,!e.equal(e.bitSlice([k,k,k,k],0,8*h),e.bitSlice(g,32*g.length-8*h,32*g.length)))throw new sjclcrp.exception.corrupt("pkcs#5 padding corrupt");return e.bitSlice(g,0,32*g.length-8*h)}}};
sjclcrp.mode.ccm={name:"ccm",encrypt:function(a,b,c,d,e){var f,g,h=b.slice(0),k=sjclcrp.bitArray,l=k.bitLength(c)/8,r=k.bitLength(h)/8;if(e=e||64,d=d||[],7>l)throw new sjclcrp.exception.invalid("ccm: iv must be at least 7 bytes");for(f=2;4>f&&r>>>8*f;f++);return 15-l>f&&(f=15-l),c=k.clamp(c,8*(15-f)),g=sjclcrp.mode.ccm._computeTag(a,b,c,d,e,f),h=sjclcrp.mode.ccm._ctrMode(a,h,c,g,e,f),k.concat(h.data,h.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f,g=sjclcrp.bitArray,h=g.bitLength(c)/8,k=
g.bitLength(b),l=g.clamp(b,k-e),r=g.bitSlice(b,k-e);if(k=(k-e)/8,7>h)throw new sjclcrp.exception.invalid("ccm: iv must be at least 7 bytes");for(b=2;4>b&&k>>>8*b;b++);if(15-h>b&&(b=15-h),c=g.clamp(c,8*(15-b)),l=sjclcrp.mode.ccm._ctrMode(a,l,c,r,e,b),f=sjclcrp.mode.ccm._computeTag(a,l.data,c,d,e,b),!g.equal(l.tag,f))throw new sjclcrp.exception.corrupt("ccm: tag doesn't match");return l.data},_computeTag:function(a,b,c,d,e,f){var g,h=[],k=sjclcrp.bitArray,l=k._xor4;if(e/=8,e%2||4>e||16<e)throw new sjclcrp.exception.invalid("ccm: invalid tag length");
if(4294967295<d.length||4294967295<b.length)throw new sjclcrp.exception.bug("ccm: can't deal with 4GiB or more data");if(g=[k.partial(8,(d.length?64:0)|e-2<<2|f-1)],g=k.concat(g,c),g[3]|=k.bitLength(b)/8,g=a.encrypt(g),d.length)for(c=k.bitLength(d)/8,65279>=c?h=[k.partial(16,c)]:4294967295>=c&&(h=k.concat([k.partial(16,65534)],[c])),h=k.concat(h,d),d=0;d<h.length;d+=4)g=a.encrypt(l(g,h.slice(d,d+4).concat([0,0,0])));for(d=0;d<b.length;d+=4)g=a.encrypt(l(g,b.slice(d,d+4).concat([0,0,0])));return k.clamp(g,
8*e)},_ctrMode:function(a,b,c,d,e,f){var g,h=sjclcrp.bitArray,k=h._xor4,l=b.length,r=h.bitLength(b);if(g=h.concat([h.partial(8,f-1)],c).concat([0,0,0]).slice(0,4),d=h.bitSlice(k(d,a.encrypt(g)),0,e),!l)return{tag:d,data:[]};for(e=0;l>e;e+=4)g[3]++,c=a.encrypt(g),b[e]^=c[0],b[e+1]^=c[1],b[e+2]^=c[2],b[e+3]^=c[3];return{tag:d,data:h.clamp(b,r)}}};
sjclcrp.codec.base32={_chars:"0123456789abcdefghjkmnpqrstvwxyz",BITS:32,BASE:5,REMAINING:27,fromBits:function(a){var b,c=(sjclcrp.codec.base32.BITS,sjclcrp.codec.base32.BASE),d=sjclcrp.codec.base32.REMAINING,e="",f=0,g=sjclcrp.codec.base32._chars,h=0,k=sjclcrp.bitArray.bitLength(a);for(b=0;e.length*c<=k;)e+=g.charAt((h^a[b]>>>f)>>>d),c>f?(h=a[b]<<c-f,f+=d,b++):(h<<=c,f-=c);return e},toBits:function(a){var b,c,d=sjclcrp.codec.base32.BITS,e=sjclcrp.codec.base32.BASE,f=sjclcrp.codec.base32.REMAINING,
g=[],h=0,k=sjclcrp.codec.base32._chars,l=0;for(b=0;b<a.length;b++){if(c=k.indexOf(a.charAt(b)),0>c)throw new sjclcrp.exception.invalid("this isn't base32!");h>f?(h-=f,g.push(l^c>>>h),l=c<<d-h):(h+=e,l^=c<<d-h)}return 56&h&&g.push(sjclcrp.bitArray.partial(56&h,l,1)),g}};
sjclcrp.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(a,b,c){var d="",e=0,f=sjclcrp.codec.base64._chars,g=0,h=sjclcrp.bitArray.bitLength(a);c&&(f=f.substr(0,62)+"-_");for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;3&d.length&&!b;)d+="=";return d},toBits:function(a,b){a=a.replace(/\s|=/g,"");var c,d,e=[],f=0,g=sjclcrp.codec.base64._chars,h=0;b&&(g=g.substr(0,62)+"-_");for(c=0;c<a.length;c++){if(d=
g.indexOf(a.charAt(c)),0>d)throw new sjclcrp.exception.invalid("this isn't base64!");26<f?(f-=26,e.push(h^d>>>f),h=d<<32-f):(f+=6,h^=d<<32-f)}return 56&f&&e.push(sjclcrp.bitArray.partial(56&f,h,1)),e}};sjclcrp.codec.base64url={fromBits:function(a){return sjclcrp.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjclcrp.codec.base64.toBits(a,1)}};
sjclcrp.codec.bytes={fromBits:function(a){var b,c,d=[],e=sjclcrp.bitArray.bitLength(a);for(b=0;e/8>b;b++)0===(3&b)&&(c=a[b/4]),d.push(c>>>24),c<<=8;return d},toBits:function(a){var b,c=[],d=0;for(b=0;b<a.length;b++)d=d<<8|a[b],3===(3&b)&&(c.push(d),d=0);return 3&b&&c.push(sjclcrp.bitArray.partial(8*(3&b),d)),c}};
sjclcrp.codec.hex={fromBits:function(a){var b,c="";for(b=0;b<a.length;b++)c+=((0|a[b])+0xf00000000000).toString(16).substr(4);return c.substr(0,sjclcrp.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[];a=a.replace(/\s|0x/g,"");var d=a.length;a+="00000000";for(b=0;b<a.length;b+=8)c.push(0^parseInt(a.substr(b,8),16));return sjclcrp.bitArray.clamp(c,4*d)}};
sjclcrp.codec.utf8String={fromBits:function(a){var b,c,d="",e=sjclcrp.bitArray.bitLength(a);for(b=0;e/8>b;b++)0===(3&b)&&(c=a[b/4]),d+=String.fromCharCode(c>>>24),c<<=8;return decodeURIComponent(escape(d))},toBits:function(a){a=unescape(encodeURIComponent(a));var b,c=[],d=0;for(b=0;b<a.length;b++)d=d<<8|a.charCodeAt(b),3===(3&b)&&(c.push(d),d=0);return 3&b&&c.push(sjclcrp.bitArray.partial(8*(3&b),d)),c}};
sjclcrp.json={defaults:{v:1,iter:1E3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(a,b,c,d){c=c||{};d=d||{};var e,f,g=sjclcrp.json,h=g._add({iv:sjclcrp.random.randomWords(4,0)},g.defaults);if(g._add(h,c),c=h.adata,"string"==typeof h.salt&&(h.salt=sjclcrp.codec.base64.toBits(h.salt)),"string"==typeof h.iv&&(h.iv=sjclcrp.codec.base64.toBits(h.iv)),!sjclcrp.mode[h.mode]||!sjclcrp.cipher[h.cipher]||"string"==typeof a&&100>=h.iter||64!==h.ts&&96!==h.ts&&128!==h.ts||128!==h.ks&&192!==
h.ks&&256!==h.ks||2>h.iv.length||4<h.iv.length)throw new sjclcrp.exception.invalid("json encrypt: invalid parameters");return"string"==typeof a?(e=sjclcrp.misc.cachedPbkdf2(a,h),a=e.key.slice(0,h.ks/32),h.salt=e.salt):sjclcrp.ecc&&a instanceof sjclcrp.ecc.elGamal.publicKey&&(e=a.kem(),h.kemtag=e.tag,a=e.key.slice(0,h.ks/32)),"string"==typeof b&&(b=sjclcrp.codec.utf8String.toBits(b)),"string"==typeof c&&(h.adata=c=sjclcrp.codec.utf8String.toBits(c)),f=new sjclcrp.cipher[h.cipher](a),g._add(d,h),d.key=
a,h.ct=sjclcrp.mode[h.mode].encrypt(f,b,h.iv,c,h.ts),h},encrypt:function(){var a=sjclcrp.json,b=a._encrypt.apply(a,arguments);return a.encode(b)},_decrypt:function(a,b,c,d){c=c||{};d=d||{};var e,f,g,h=sjclcrp.json;b=h._add(h._add(h._add({},h.defaults),b),c,!0);var k=b.adata;if("string"==typeof b.salt&&(b.salt=sjclcrp.codec.base64.toBits(b.salt)),"string"==typeof b.iv&&(b.iv=sjclcrp.codec.base64.toBits(b.iv)),!sjclcrp.mode[b.mode]||!sjclcrp.cipher[b.cipher]||"string"==typeof a&&100>=b.iter||64!==b.ts&&
96!==b.ts&&128!==b.ts||128!==b.ks&&192!==b.ks&&256!==b.ks||!b.iv||2>b.iv.length||4<b.iv.length)throw new sjclcrp.exception.invalid("json decrypt: invalid parameters");return"string"==typeof a?(f=sjclcrp.misc.cachedPbkdf2(a,b),a=f.key.slice(0,b.ks/32),b.salt=f.salt):sjclcrp.ecc&&a instanceof sjclcrp.ecc.elGamal.secretKey&&(a=a.unkem(sjclcrp.codec.base64.toBits(b.kemtag)).slice(0,b.ks/32)),"string"==typeof k&&(k=sjclcrp.codec.utf8String.toBits(k)),g=new sjclcrp.cipher[b.cipher](a),e=sjclcrp.mode[b.mode].decrypt(g,
b.ct,b.iv,k,b.ts),h._add(d,b),d.key=a,1===c.raw?e:sjclcrp.codec.utf8String.fromBits(e)},decrypt:function(a,b,c,d){var e=sjclcrp.json;return e._decrypt(a,e.decode(b),c,d)},encode:function(a){var b,c="{",d="";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjclcrp.exception.invalid("json encode: invalid property name");switch(c+=d+'"'+b+'":',d=",",typeof a[b]){case "number":case "boolean":c+=a[b];break;case "string":c+='"'+escape(a[b])+'"';break;case "object":c+='"'+sjclcrp.codec.base64.fromBits(a[b],
0)+'"';break;default:throw new sjclcrp.exception.bug("json encode: unsupported type");}}return c+"}"},decode:function(a){if(a=a.replace(/\s/g,""),!a.match(/^\{.*\}$/))throw new sjclcrp.exception.invalid("json decode: this isn't json!");var b,c=a.replace(/^\{|\}$/g,"").split(/,/),d={};for(a=0;a<c.length;a++){if(!(b=c[a].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new sjclcrp.exception.invalid("json decode: this isn't json!");b[3]?d[b[2]]=
parseInt(b[3],10):b[4]?d[b[2]]=b[2].match(/^(ct|adata|salt|iv)$/)?sjclcrp.codec.base64.toBits(b[4]):unescape(b[4]):b[5]&&(d[b[2]]="true"===b[5])}return d},_add:function(a,b,c){if(void 0===a&&(a={}),void 0===b)return a;for(var d in b)if(b.hasOwnProperty(d)){if(c&&void 0!==a[d]&&a[d]!==b[d])throw new sjclcrp.exception.invalid("required parameter overridden");a[d]=b[d]}return a},_subtract:function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&a[c]!==b[c]&&(d[c]=a[c]);return d},_filter:function(a,b){var c,
d={};for(c=0;c<b.length;c++)void 0!==a[b[c]]&&(d[b[c]]=a[b[c]]);return d}};sjclcrp.encrypt=sjclcrp.json.encrypt;sjclcrp.decrypt=sjclcrp.json.decrypt;sjclcrp.misc._pbkdf2Cache={};sjclcrp.misc.cachedPbkdf2=function(a,b){var c,d,e,f,g=sjclcrp.misc._pbkdf2Cache;return b=b||{},f=b.iter||1E3,d=g[a]=g[a]||{},c=d[f]=d[f]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjclcrp.random.randomWords(2,0)},e=void 0===b.salt?c.firstSalt:b.salt,c[e]=c[e]||sjclcrp.misc.pbkdf2(a,e,b.iter),{key:c[e].slice(0),salt:e.slice(0)}};
sjclcrp.ecc={};sjclcrp.ecc.point=function(a,b,c){void 0===b?this.isIdentity=!0:(b instanceof sjclcrp.bn&&(b=new a.field(b)),c instanceof sjclcrp.bn&&(c=new a.field(c)),this.x=b,this.y=c,this.isIdentity=!1);this.curve=a};
sjclcrp.ecc.point.prototype={toJac:function(){return new sjclcrp.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(a){return this.toJac().mult(a,this).toAffine()},mult2:function(a,b,c){return this.toJac().mult2(a,this,b,c).toAffine()},multiples:function(){var a;if(void 0===this._multiples){var b=this.toJac().doubl();var c=this._multiples=[new sjclcrp.ecc.point(this.curve),this,b.toAffine()];for(a=3;16>a;a++)b=b.add(this),c.push(b.toAffine())}return this._multiples},negate:function(){var a=
(new this.curve.field(0)).sub(this.y).normalize().reduce();return new sjclcrp.ecc.point(this.curve,this.x,a)},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return sjclcrp.bitArray.concat(this.x.toBits(),this.y.toBits())}};sjclcrp.ecc.pointJac=function(a,b,c,d){void 0===b?this.isIdentity=!0:(this.x=b,this.y=c,this.z=d,this.isIdentity=!1);this.curve=a};
sjclcrp.ecc.pointJac.prototype={add:function(a){var b,c,d,e,f,g,h,k,l,r,q;if(this.curve!==a.curve)throw"sjclcrp.ecc.add(): Points must be on the same curve to add them!";return this.isIdentity?a.toJac():a.isIdentity?this:(b=this.z.square(),c=a.x.mul(b).subM(this.x),c.equals(0)?this.y.equals(a.y.mul(b.mul(this.z)))?this.doubl():new sjclcrp.ecc.pointJac(this.curve):(d=a.y.mul(b.mul(this.z)).subM(this.y),e=c.square(),f=d.square(),g=c.square().mul(c).addM(this.x.add(this.x).mul(e)),h=f.subM(g),k=this.x.mul(e).subM(h).mul(d),
l=this.y.mul(c.square().mul(c)),r=k.subM(l),q=this.z.mul(c),new sjclcrp.ecc.pointJac(this.curve,h,r,q)))},doubl:function(){if(this.isIdentity)return this;var a=this.y.square(),b=a.mul(this.x.mul(4)),c=a.square().mul(8);a=this.z.square();var d=this.curve.a.toString()==(new sjclcrp.bn(-3)).toString()?this.x.sub(a).mul(3).mul(this.x.add(a)):this.x.square().mul(3).add(a.square().mul(this.curve.a));a=d.square().subM(b).subM(b);b=b.sub(a).mul(d).subM(c);c=this.y.add(this.y).mul(this.z);return new sjclcrp.ecc.pointJac(this.curve,
a,b,c)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new sjclcrp.ecc.point(this.curve);var a=this.z.inverse(),b=a.square();return new sjclcrp.ecc.point(this.curve,this.x.mul(b).fullReduce(),this.y.mul(b.mul(a)).fullReduce())},mult:function(a,b){"number"==typeof a?a=[a]:void 0!==a.limbs&&(a=a.normalize().limbs);var c,d,e=(new sjclcrp.ecc.point(this.curve)).toJac(),f=b.multiples();for(c=a.length-1;0<=c;c--)for(d=sjclcrp.bn.prototype.radix-4;0<=d;d-=4)e=e.doubl().doubl().doubl().doubl().add(f[a[c]>>
d&15]);return e},mult2:function(a,b,c,d){"number"==typeof a?a=[a]:void 0!==a.limbs&&(a=a.normalize().limbs);"number"==typeof c?c=[c]:void 0!==c.limbs&&(c=c.normalize().limbs);var e,f=(new sjclcrp.ecc.point(this.curve)).toJac();b=b.multiples();var g=d.multiples();for(d=Math.max(a.length,c.length)-1;0<=d;d--){var h=0|a[d];var k=0|c[d];for(e=sjclcrp.bn.prototype.radix-4;0<=e;e-=4)f=f.doubl().doubl().doubl().doubl().add(b[h>>e&15]).add(g[k>>e&15])}return f},negate:function(){return this.toAffine().negate().toJac()},
isValid:function(){var a=this.z.square(),b=a.square();a=b.mul(a);return this.y.square().equals(this.curve.b.mul(a).add(this.x.mul(this.curve.a.mul(b).add(this.x.square()))))}};sjclcrp.ecc.curve=function(a,b,c,d,e,f){this.field=a;this.r=new sjclcrp.bn(b);this.a=new a(c);this.b=new a(d);this.G=new sjclcrp.ecc.point(this,new a(e),new a(f))};
sjclcrp.ecc.curve.prototype.fromBits=function(a){var b=sjclcrp.bitArray,c=this.field.prototype.exponent+7&-8;a=new sjclcrp.ecc.point(this,this.field.fromBits(b.bitSlice(a,0,c)),this.field.fromBits(b.bitSlice(a,c,2*c)));if(!a.isValid())throw new sjclcrp.exception.corrupt("not on the curve!");return a};
sjclcrp.ecc.curves={c192:new sjclcrp.ecc.curve(sjclcrp.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new sjclcrp.ecc.curve(sjclcrp.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21",
"0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new sjclcrp.ecc.curve(sjclcrp.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new sjclcrp.ecc.curve(sjclcrp.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",
-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),k192:new sjclcrp.ecc.curve(sjclcrp.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),
k224:new sjclcrp.ecc.curve(sjclcrp.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),k256:new sjclcrp.ecc.curve(sjclcrp.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")};
sjclcrp.ecc.basicKey={publicKey:function(a,b){this._curve=a;this._curveBitLength=a.r.bitLength();this._point=b instanceof Array?a.fromBits(b):b;this.get=function(){var c=this._point.toBits(),d=sjclcrp.bitArray.bitLength(c),e=sjclcrp.bitArray.bitSlice(c,0,d/2);c=sjclcrp.bitArray.bitSlice(c,d/2);return{x:e,y:c}}},secretKey:function(a,b){this._curve=a;this._curveBitLength=a.r.bitLength();this._exponent=b;this.get=function(){return this._exponent.toBits()}}};
sjclcrp.ecc.basicKey.generateKeys=function(a){return function(b,c,d){if(b=b||256,"number"==typeof b&&(b=sjclcrp.ecc.curves["c"+b],void 0===b))throw new sjclcrp.exception.invalid("no such curve");d=d||sjclcrp.bn.random(b.r,c);c=b.G.mult(d);return{pub:new sjclcrp.ecc[a].publicKey(b,c),sec:new sjclcrp.ecc[a].secretKey(b,d)}}};
sjclcrp.ecc.elGamal={generateKeys:sjclcrp.ecc.basicKey.generateKeys("elGamal"),publicKey:function(){sjclcrp.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function(){sjclcrp.ecc.basicKey.secretKey.apply(this,arguments)}};sjclcrp.ecc.elGamal.publicKey.prototype={kem:function(a){a=sjclcrp.bn.random(this._curve.r,a);var b=this._curve.G.mult(a).toBits();return{key:sjclcrp.hash.sha256.hash(this._point.mult(a).toBits()),tag:b}}};
sjclcrp.ecc.elGamal.secretKey.prototype={unkem:function(a){return sjclcrp.hash.sha256.hash(this._curve.fromBits(a).mult(this._exponent).toBits())},dh:function(a){return sjclcrp.hash.sha256.hash(a._point.mult(this._exponent).toBits())},dhJavaEc:function(a){return a._point.mult(this._exponent).x.toBits()}};sjclcrp.ecc.ecdsa={generateKeys:sjclcrp.ecc.basicKey.generateKeys("ecdsa")};sjclcrp.ecc.ecdsa.publicKey=function(){sjclcrp.ecc.basicKey.publicKey.apply(this,arguments)};
sjclcrp.ecc.ecdsa.publicKey.prototype={verify:function(a,b,c){sjclcrp.bitArray.bitLength(a)>this._curveBitLength&&(a=sjclcrp.bitArray.clamp(a,this._curveBitLength));var d=sjclcrp.bitArray,e=this._curve.r,f=this._curveBitLength,g=sjclcrp.bn.fromBits(d.bitSlice(b,0,f));d=sjclcrp.bn.fromBits(d.bitSlice(b,f,2*f));var h=c?d:d.inverseMod(e);f=sjclcrp.bn.fromBits(a).mul(h).mod(e);h=g.mul(h).mod(e);f=this._curve.G.mult2(f,h,this._point).x;if(g.equals(0)||d.equals(0)||g.greaterEquals(e)||d.greaterEquals(e)||
!f.equals(g)){if(void 0===c)return this.verify(a,b,!0);throw new sjclcrp.exception.corrupt("signature didn't check out");}return!0}};sjclcrp.ecc.ecdsa.secretKey=function(){sjclcrp.ecc.basicKey.secretKey.apply(this,arguments)};
sjclcrp.ecc.ecdsa.secretKey.prototype={sign:function(a,b,c,d){sjclcrp.bitArray.bitLength(a)>this._curveBitLength&&(a=sjclcrp.bitArray.clamp(a,this._curveBitLength));var e=this._curve.r,f=e.bitLength();d=d||sjclcrp.bn.random(e.sub(1),b).add(1);b=this._curve.G.mult(d).x.mod(e);a=sjclcrp.bn.fromBits(a).add(b.mul(this._exponent));c=c?a.inverseMod(e).mul(d).mod(e):a.mul(d.inverseMod(e)).mod(e);return sjclcrp.bitArray.concat(b.toBits(f),c.toBits(f))}};
sjclcrp.mode.gcm={name:"gcm",encrypt:function(a,b,c,d,e){var f;b=b.slice(0);var g=sjclcrp.bitArray;return e=e||128,d=d||[],f=sjclcrp.mode.gcm._ctrMode(!0,a,b,d,c,e),g.concat(f.data,f.tag)},decrypt:function(a,b,c,d,e){var f,g;b=b.slice(0);var h=sjclcrp.bitArray,k=h.bitLength(b);if(e=e||128,d=d||[],k>=e?(g=h.bitSlice(b,k-e),b=h.bitSlice(b,0,k-e)):(g=b,b=[]),f=sjclcrp.mode.gcm._ctrMode(!1,a,b,d,c,e),!h.equal(f.tag,g))throw new sjclcrp.exception.corrupt("gcm: tag doesn't match");return f.data},_galoisMultiply:function(a,
b){var c,d,e=sjclcrp.bitArray._xor4;var f=[0,0,0,0];var g=b.slice(0);for(c=0;128>c;c++){(d=0!==(a[Math.floor(c/32)]&1<<31-c%32))&&(f=e(f,g));var h=0!==(1&g[3]);for(d=3;0<d;d--)g[d]=g[d]>>>1|(1&g[d-1])<<31;g[0]>>>=1;h&&(g[0]^=-520093696)}return f},_ghash:function(a,b,c){var d,e=c.length;b=b.slice(0);for(d=0;e>d;d+=4)b[0]^=4294967295&c[d],b[1]^=4294967295&c[d+1],b[2]^=4294967295&c[d+2],b[3]^=4294967295&c[d+3],b=sjclcrp.mode.gcm._galoisMultiply(b,a);return b},_ctrMode:function(a,b,c,d,e,f){var g,h,k=
sjclcrp.bitArray;var l=c.length;var r=k.bitLength(c);var q=k.bitLength(d);var m=k.bitLength(e);var n=b.encrypt([0,0,0,0]);96===m?(g=e.slice(0),g=k.concat(g,[1])):(g=sjclcrp.mode.gcm._ghash(n,[0,0,0,0],e),g=sjclcrp.mode.gcm._ghash(n,g,[0,0,Math.floor(m/4294967296),4294967295&m]));d=sjclcrp.mode.gcm._ghash(n,[0,0,0,0],d);m=g.slice(0);var p=d.slice(0);a||(p=sjclcrp.mode.gcm._ghash(n,d,c));for(e=0;l>e;e+=4){m[3]++;var t=b.encrypt(m);c[e]^=t[0];c[e+1]^=t[1];c[e+2]^=t[2];c[e+3]^=t[3]}return c=k.clamp(c,
r),a&&(p=sjclcrp.mode.gcm._ghash(n,d,c)),h=[Math.floor(q/4294967296),4294967295&q,Math.floor(r/4294967296),4294967295&r],p=sjclcrp.mode.gcm._ghash(n,p,h),t=b.encrypt(g),p[0]^=t[0],p[1]^=t[1],p[2]^=t[2],p[3]^=t[3],{tag:k.bitSlice(p,0,f),data:c}}};
sjclcrp.misc.hmac=function(a,b){this._hash=b=b||sjclcrp.hash.sha256;var c,d=[[],[]],e=b.prototype.blockSize/32;this._baseHash=[new b,new b];a.length>e&&(a=b.hash(a));for(c=0;e>c;c++)d[0][c]=909522486^a[c],d[1][c]=1549556828^a[c];this._baseHash[0].update(d[0]);this._baseHash[1].update(d[1]);this._resultHash=new b(this._baseHash[0])};
sjclcrp.misc.hmac.prototype.encrypt=sjclcrp.misc.hmac.prototype.mac=function(a){if(this._updated)throw new sjclcrp.exception.invalid("encrypt on already updated hmac called!");return this.update(a),this.digest(a)};sjclcrp.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]);this._updated=!1};sjclcrp.misc.hmac.prototype.update=function(a){this._updated=!0;this._resultHash.update(a)};
sjclcrp.misc.hmac.prototype.digest=function(){var a=this._resultHash.finalize();a=(new this._hash(this._baseHash[1])).update(a).finalize();return this.reset(),a};
sjclcrp.mode.ocb2={name:"ocb2",encrypt:function(a,b,c,d,e,f){if(128!==sjclcrp.bitArray.bitLength(c))throw new sjclcrp.exception.invalid("ocb iv must be 128 bits");var g,h,k=sjclcrp.mode.ocb2._times2,l=sjclcrp.bitArray,r=l._xor4,q=[0,0,0,0],m=k(a.encrypt(c)),n=[];d=d||[];e=e||64;for(c=0;c+4<b.length;c+=4){var p=b.slice(c,c+4);q=r(q,p);n=n.concat(r(m,a.encrypt(r(m,p))));m=k(m)}return p=b.slice(c),g=l.bitLength(p),h=a.encrypt(r(m,[0,0,0,g])),p=l.clamp(r(p.concat([0,0,0]),h),g),q=r(q,r(p.concat([0,0,
0]),h)),q=a.encrypt(r(q,r(m,k(m)))),d.length&&(q=r(q,f?d:sjclcrp.mode.ocb2.pmac(a,d))),n.concat(l.concat(p,l.clamp(q,e)))},decrypt:function(a,b,c,d,e,f){if(128!==sjclcrp.bitArray.bitLength(c))throw new sjclcrp.exception.invalid("ocb iv must be 128 bits");e=e||64;var g,h,k=sjclcrp.mode.ocb2._times2,l=sjclcrp.bitArray,r=l._xor4,q=[0,0,0,0],m=k(a.encrypt(c)),n=sjclcrp.bitArray.bitLength(b)-e,p=[];d=d||[];for(c=0;n/32>c+4;c+=4){var t=r(m,a.decrypt(r(m,b.slice(c,c+4))));q=r(q,t);p=p.concat(t);m=k(m)}if(g=
n-32*c,h=a.encrypt(r(m,[0,0,0,g])),t=r(h,l.clamp(b.slice(c),g).concat([0,0,0])),q=r(q,t),q=a.encrypt(r(q,r(m,k(m)))),d.length&&(q=r(q,f?d:sjclcrp.mode.ocb2.pmac(a,d))),!l.equal(l.clamp(q,e),l.bitSlice(b,n)))throw new sjclcrp.exception.corrupt("ocb: tag doesn't match");return p.concat(l.clamp(t,g))},pmac:function(a,b){var c,d,e=sjclcrp.mode.ocb2._times2,f=sjclcrp.bitArray,g=f._xor4,h=[0,0,0,0],k=a.encrypt([0,0,0,0]);k=g(k,e(e(k)));for(c=0;c+4<b.length;c+=4)k=e(k),h=g(h,a.encrypt(g(k,b.slice(c,c+4))));
return d=b.slice(c),128>f.bitLength(d)&&(k=g(k,e(k)),d=f.concat(d,[-2147483648,0,0,0])),h=g(h,d),a.encrypt(g(e(g(k,e(k))),h))},_times2:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^135*(a[0]>>>31)]}};
sjclcrp.misc.pbkdf2=function(a,b,c,d,e){if(c=c||1E3,0>d||0>c)throw sjclcrp.exception.invalid("invalid params to pbkdf2");"string"==typeof a&&(a=sjclcrp.codec.utf8String.toBits(a));"string"==typeof b&&(b=sjclcrp.codec.utf8String.toBits(b));e=e||sjclcrp.misc.hmac;var f,g,h,k=new e(a),l=[],r=sjclcrp.bitArray;for(h=1;32*l.length<(d||1);h++){a=e=k.encrypt(r.concat(b,[h]));for(f=1;c>f;f++)for(e=k.encrypt(e),g=0;g<e.length;g++)a[g]^=e[g];l=l.concat(a)}return d&&(l=r.clamp(l,d)),l};
!function(){function a(m,n){return m<<n|m>>>32-n}function b(m){return(255&m)<<24|(65280&m)<<8|(m&16711680)>>>8|(m&-16777216)>>>24}function c(m){for(var n,p=this._h[0],t=this._h[1],w=this._h[2],z=this._h[3],C=this._h[4],E=this._h[0],x=this._h[1],v=this._h[2],A=this._h[3],B=this._h[4],u=0;16>u;++u)n=a(p+(t^w^z)+m[k[u]]+e[u],r[u])+C,p=C,C=z,z=a(w,10),w=t,t=n,n=a(E+(x^(v|~A))+m[l[u]]+f[u],q[u])+B,E=B,B=A,A=a(v,10),v=x,x=n;for(;32>u;++u)n=a(p+(t&w|~t&z)+m[k[u]]+e[u],r[u])+C,p=C,C=z,z=a(w,10),w=t,t=n,n=
a(E+(x&A|v&~A)+m[l[u]]+f[u],q[u])+B,E=B,B=A,A=a(v,10),v=x,x=n;for(;48>u;++u)n=a(p+((t|~w)^z)+m[k[u]]+e[u],r[u])+C,p=C,C=z,z=a(w,10),w=t,t=n,n=a(E+((x|~v)^A)+m[l[u]]+f[u],q[u])+B,E=B,B=A,A=a(v,10),v=x,x=n;for(;64>u;++u)n=a(p+(t&z|w&~z)+m[k[u]]+e[u],r[u])+C,p=C,C=z,z=a(w,10),w=t,t=n,n=a(E+(x&v|~x&A)+m[l[u]]+f[u],q[u])+B,E=B,B=A,A=a(v,10),v=x,x=n;for(;80>u;++u)n=a(p+(t^(w|~z))+m[k[u]]+e[u],r[u])+C,p=C,C=z,z=a(w,10),w=t,t=n,n=a(E+(x^v^A)+m[l[u]]+f[u],q[u])+B,E=B,B=A,A=a(v,10),v=x,x=n;n=this._h[1]+w+A;
this._h[1]=this._h[2]+z+B;this._h[2]=this._h[3]+C+E;this._h[3]=this._h[4]+p+x;this._h[4]=this._h[0]+t+v;this._h[0]=n}sjclcrp.hash.ripemd160=function(m){m?(this._h=m._h.slice(0),this._buffer=m._buffer.slice(0),this._length=m._length):this.reset()};sjclcrp.hash.ripemd160.hash=function(m){return(new sjclcrp.hash.ripemd160).update(m).finalize()};sjclcrp.hash.ripemd160.prototype={reset:function(){return this._h=d.slice(0),this._buffer=[],this._length=0,this},update:function(m){"string"==typeof m&&(m=sjclcrp.codec.utf8String.toBits(m));
var n=this._buffer=sjclcrp.bitArray.concat(this._buffer,m);var p=this._length;m=this._length=p+sjclcrp.bitArray.bitLength(m);for(p=512+p&-512;m>=p;p+=512){for(var t=n.splice(0,16),w=0;16>w;++w)t[w]=b(t[w]);c.call(this,t)}return this},finalize:function(){var m=sjclcrp.bitArray.concat(this._buffer,[sjclcrp.bitArray.partial(1,1)]),n=(this._length+1)%512;n=(448<n?512:448)-n%448;var p=n%32;for(0<p&&(m=sjclcrp.bitArray.concat(m,[sjclcrp.bitArray.partial(p,0)]));32<=n;n-=32)m.push(0);m.push(b(0|this._length));
for(m.push(b(Math.floor(this._length/4294967296)));m.length;){p=m.splice(0,16);for(n=0;16>n;++n)p[n]=b(p[n]);c.call(this,p)}m=this._h;this.reset();for(n=0;5>n;++n)m[n]=b(m[n]);return m}};for(var d=[1732584193,4023233417,2562383102,271733878,3285377520],e=[0,1518500249,1859775393,2400959708,2840853838],f=[1352829926,1548603684,1836072691,2053994217,0],g=4;0<=g;--g)for(var h=1;16>h;++h)e.splice(g,0,e[g]),f.splice(g,0,f[g]);var k=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,
11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],l=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],r=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,
13,14,11,8,5,6],q=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]}();sjclcrp.hash.sha1=function(a){a?(this._h=a._h.slice(0),this._buffer=a._buffer.slice(0),this._length=a._length):this.reset()};sjclcrp.hash.sha1.hash=function(a){return(new sjclcrp.hash.sha1).update(a).finalize()};
sjclcrp.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(a){"string"==typeof a&&(a=sjclcrp.codec.utf8String.toBits(a));var b=this._buffer=sjclcrp.bitArray.concat(this._buffer,a);var c=this._length;a=this._length=c+sjclcrp.bitArray.bitLength(a);for(c=this.blockSize+c&-this.blockSize;a>=c;c+=this.blockSize)this._block(b.splice(0,16));return this},finalize:function(){var a,b=this._buffer,c=this._h;b=sjclcrp.bitArray.concat(b,
[sjclcrp.bitArray.partial(1,1)]);for(a=b.length+2;15&a;a++)b.push(0);b.push(Math.floor(this._length/4294967296));for(b.push(0|this._length);b.length;)this._block(b.splice(0,16));return this.reset(),c},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(a,b,c,d){return 19>=a?b&c|~b&d:39>=a?b^c^d:59>=a?b&c|b&d|c&d:79>=a?b^c^d:void 0},_S:function(a,b){return b<<a|b>>>32-a},_block:function(a){var b=a.slice(0),c=this._h;var d=c[0];
var e=c[1];var f=c[2];var g=c[3];var h=c[4];for(a=0;79>=a;a++){16<=a&&(b[a]=this._S(1,b[a-3]^b[a-8]^b[a-14]^b[a-16]));var k=this._S(5,d)+this._f(a,e,f,g)+h+b[a]+this._key[Math.floor(a/20)]|0;h=g;g=f;f=this._S(30,e);e=d;d=k}c[0]=c[0]+d|0;c[1]=c[1]+e|0;c[2]=c[2]+f|0;c[3]=c[3]+g|0;c[4]=c[4]+h|0}};sjclcrp.hash.sha256=function(a){this._key[0]||this._precompute();a?(this._h=a._h.slice(0),this._buffer=a._buffer.slice(0),this._length=a._length):this.reset()};sjclcrp.hash.sha256.hash=function(a){return(new sjclcrp.hash.sha256).update(a).finalize()};
sjclcrp.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(a){"string"==typeof a&&(a=sjclcrp.codec.utf8String.toBits(a));var b=this._buffer=sjclcrp.bitArray.concat(this._buffer,a);var c=this._length;a=this._length=c+sjclcrp.bitArray.bitLength(a);for(c=512+c&-512;a>=c;c+=512)this._block(b.splice(0,16));return this},finalize:function(){var a,b=this._buffer,c=this._h;b=sjclcrp.bitArray.concat(b,[sjclcrp.bitArray.partial(1,
1)]);for(a=b.length+2;15&a;a++)b.push(0);b.push(Math.floor(this._length/4294967296));for(b.push(0|this._length);b.length;)this._block(b.splice(0,16));return this.reset(),c},_init:[],_key:[],_precompute:function(){function a(e){return 4294967296*(e-Math.floor(e))|0}var b,c=0,d=2;a:for(;64>c;d++){for(b=2;d>=b*b;b++)if(0===d%b)continue a;8>c&&(this._init[c]=a(Math.pow(d,.5)));this._key[c]=a(Math.pow(d,1/3));c++}},_block:function(a){var b,c,d,e=a.slice(0),f=this._h,g=this._key,h=f[0],k=f[1],l=f[2],r=
f[3],q=f[4],m=f[5],n=f[6],p=f[7];for(a=0;64>a;a++)16>a?b=e[a]:(c=e[a+1&15],d=e[a+14&15],b=e[15&a]=(c>>>7^c>>>18^c>>>3^c<<25^c<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+e[15&a]+e[a+9&15]|0),b=b+p+(q>>>6^q>>>11^q>>>25^q<<26^q<<21^q<<7)+(n^q&(m^n))+g[a],p=n,n=m,m=q,q=r+b|0,r=l,l=k,k=h,h=b+(k&l^r&(k^l))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0;f[0]=f[0]+h|0;f[1]=f[1]+k|0;f[2]=f[2]+l|0;f[3]=f[3]+r|0;f[4]=f[4]+q|0;f[5]=f[5]+m|0;f[6]=f[6]+n|0;f[7]=f[7]+p|0}};
sjclcrp.hash.sha512=function(a){this._key[0]||this._precompute();a?(this._h=a._h.slice(0),this._buffer=a._buffer.slice(0),this._length=a._length):this.reset()};sjclcrp.hash.sha512.hash=function(a){return(new sjclcrp.hash.sha512).update(a).finalize()};
sjclcrp.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(a){"string"==typeof a&&(a=sjclcrp.codec.utf8String.toBits(a));var b=this._buffer=sjclcrp.bitArray.concat(this._buffer,a);var c=this._length;a=this._length=c+sjclcrp.bitArray.bitLength(a);for(c=1024+c&-1024;a>=c;c+=1024)this._block(b.splice(0,32));return this},finalize:function(){var a,b=this._buffer,c=this._h;b=sjclcrp.bitArray.concat(b,[sjclcrp.bitArray.partial(1,
1)]);for(a=b.length+4;31&a;a++)b.push(0);b.push(0);b.push(0);b.push(Math.floor(this._length/4294967296));for(b.push(0|this._length);b.length;)this._block(b.splice(0,32));return this.reset(),c},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,
16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){function a(f){return 4294967296*
(f-Math.floor(f))|0}function b(f){return 1099511627776*(f-Math.floor(f))&255}var c,d=0,e=2;a:for(;80>d;e++){for(c=2;e>=c*c;c++)if(0===e%c)continue a;8>d&&(this._init[2*d]=a(Math.pow(e,.5)),this._init[2*d+1]=b(Math.pow(e,.5))<<24|this._initr[d]);this._key[2*d]=a(Math.pow(e,1/3));this._key[2*d+1]=b(Math.pow(e,1/3))<<24|this._keyr[d];d++}},_block:function(a){var b=a.slice(0),c=this._h,d=this._key,e=c[0],f=c[1],g=c[2],h=c[3],k=c[4],l=c[5],r=c[6],q=c[7],m=c[8],n=c[9],p=c[10],t=c[11],w=c[12],z=c[13],C=
c[14],E=c[15],x=e,v=f,A=g,B=h,u=k,K=l,S=r,L=q,G=m,F=n,Q=p,M=t,R=w,N=z,T=C,O=E;for(a=0;80>a;a++){if(16>a){var I=b[2*a];var y=b[2*a+1]}else{y=b[2*(a-15)];var D=b[2*(a-15)+1];I=(D<<31|y>>>1)^(D<<24|y>>>8)^y>>>7;var J=(y<<31|D>>>1)^(y<<24|D>>>8)^(y<<25|D>>>7);y=b[2*(a-2)];var H=b[2*(a-2)+1];D=(H<<13|y>>>19)^(y<<3|H>>>29)^y>>>6;H=(y<<13|H>>>19)^(H<<3|y>>>29)^(y<<26|H>>>6);var U=b[2*(a-7)],V=b[2*(a-16)],P=b[2*(a-16)+1];y=J+b[2*(a-7)+1];I=I+U+(J>>>0>y>>>0?1:0);y+=H;I+=D+(H>>>0>y>>>0?1:0);y+=P;I+=V+(P>>>
0>y>>>0?1:0)}b[2*a]=I|=0;b[2*a+1]=y|=0;U=G&Q^~G&R;var W=F&M^~F&N;H=x&A^x&u^A&u;var Y=v&B^v&K^B&K;V=(v<<4|x>>>28)^(x<<30|v>>>2)^(x<<25|v>>>7);P=(x<<4|v>>>28)^(v<<30|x>>>2)^(v<<25|x>>>7);var Z=d[2*a],X=d[2*a+1];D=O+((G<<18|F>>>14)^(G<<14|F>>>18)^(F<<23|G>>>9));J=T+((F<<18|G>>>14)^(F<<14|G>>>18)^(G<<23|F>>>9))+(O>>>0>D>>>0?1:0);D+=W;J+=U+(W>>>0>D>>>0?1:0);D+=X;J+=Z+(X>>>0>D>>>0?1:0);D=D+y|0;J+=I+(y>>>0>D>>>0?1:0);y=P+Y;I=V+H+(P>>>0>y>>>0?1:0);T=R;O=N;R=Q;N=M;Q=G;M=F;F=L+D|0;G=S+J+(L>>>0>F>>>0?1:0)|0;
S=u;L=K;u=A;K=B;A=x;B=v;v=D+y|0;x=J+I+(D>>>0>v>>>0?1:0)|0}f=c[1]=f+v|0;c[0]=e+x+(v>>>0>f>>>0?1:0)|0;h=c[3]=h+B|0;c[2]=g+A+(B>>>0>h>>>0?1:0)|0;l=c[5]=l+K|0;c[4]=k+u+(K>>>0>l>>>0?1:0)|0;q=c[7]=q+L|0;c[6]=r+S+(L>>>0>q>>>0?1:0)|0;n=c[9]=n+F|0;c[8]=m+G+(F>>>0>n>>>0?1:0)|0;t=c[11]=t+M|0;c[10]=p+Q+(M>>>0>t>>>0?1:0)|0;z=c[13]=z+N|0;c[12]=w+R+(N>>>0>z>>>0?1:0)|0;E=c[15]=E+O|0;c[14]=C+T+(O>>>0>E>>>0?1:0)|0}};
sjclcrp.keyexchange.srp={makeVerifier:function(a,b,c,d){var e;return e=sjclcrp.keyexchange.srp.makeX(a,b,c),e=sjclcrp.bn.fromBits(e),d.g.powermod(e,d.N)},makeX:function(a,b,c){a=sjclcrp.hash.sha1.hash(a+":"+b);return sjclcrp.hash.sha1.hash(sjclcrp.bitArray.concat(c,a))},knownGroup:function(a){return"string"!=typeof a&&(a=a.toString()),sjclcrp.keyexchange.srp._didInitKnownGroups||sjclcrp.keyexchange.srp._initKnownGroups(),sjclcrp.keyexchange.srp._knownGroups[a]},_didInitKnownGroups:!1,_initKnownGroups:function(){var a;
for(a=0;a<sjclcrp.keyexchange.srp._knownGroupSizes.length;a++){var b=sjclcrp.keyexchange.srp._knownGroupSizes[a].toString();b=sjclcrp.keyexchange.srp._knownGroups[b];b.N=new sjclcrp.bn(b.N);b.g=new sjclcrp.bn(b.g)}sjclcrp.keyexchange.srp._didInitKnownGroups=!0},_knownGroupSizes:[1024,1536,2048],_knownGroups:{1024:{N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",
g:2},1536:{N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB",g:2},2048:{N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",
g:2}}};
sjclcrp.prng=function(a){this._pools=[new sjclcrp.hash.sha256];this._poolEntropy=[0];this._reseedCount=0;this._robins={};this._eventId=0;this._collectorIds={};this._nextReseed=this._poolStrength=this._strength=this._collectorIdNext=0;this._key=[0,0,0,0,0,0,0,0];this._counter=[0,0,0,0];this._cipher=void 0;this._defaultParanoia=a;this._collectorsStarted=!1;this._callbacks={progress:{},seeded:{}};this._NOT_READY=this._callbackI=0;this._READY=1;this._REQUIRES_RESEED=2;this._MAX_WORDS_PER_BURST=65536;
this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024];this._MILLISECONDS_PER_RESEED=3E4;this._BITS_PER_RESEED=80};
sjclcrp.prng.prototype={randomWords:function(a,b){var c=[];var d=this.isReady(b);if(d===this._NOT_READY)throw new sjclcrp.exception.notReady("generator isn't seeded");d&this._REQUIRES_RESEED&&this._reseedFromPools(!(d&this._READY));for(d=0;a>d;d+=4){0===(d+1)%this._MAX_WORDS_PER_BURST&&this._gate();var e=this._gen4words();c.push(e[0],e[1],e[2],e[3])}return this._gate(),c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==
b)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),g=this._robins[c],h=this.isReady(),k=0;switch(d=this._collectorIds[c],void 0===d&&(d=this._collectorIds[c]=this._collectorIdNext++),void 0===g&&(g=this._robins[c]=0),this._robins[c]=(this._robins[c]+1)%this._pools.length,typeof a){case "number":void 0===b&&(b=1);this._pools[g].update([d,this._eventId++,1,b,f,1,0|a]);break;case "object":if(e=
Object.prototype.toString.call(a),"[object Uint32Array]"===e){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==e&&(k=1),c=0;c<a.length&&!k;c++)"number"!=typeof a[c]&&(k=1);if(!k){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e>>>=1;this._pools[g].update([d,this._eventId++,2,b,f,a.length].concat(a))}break;case "string":void 0===b&&(b=a.length);this._pools[g].update([d,this._eventId++,3,b,f,a.length]);this._pools[g].update(a);break;default:k=1}if(k)throw new sjclcrp.exception.bug("random: addEntropy only supports number, array of numbers or string");
this._poolEntropy[g]+=b;this._poolStrength+=b;h===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(a){a=this._PARANOIA_LEVELS[void 0!==a?a:this._defaultParanoia];return this._strength&&this._strength>=a?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=a?this._REQUIRES_RESEED|
this._NOT_READY:this._NOT_READY},getProgress:function(a){a=this._PARANOIA_LEVELS[a?a:this._defaultParanoia];return this._strength>=a?1:this._poolStrength>a?1:this._poolStrength/a},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},
window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new sjclcrp.exception.bug("can't attach event");document.attachEvent("onload",
this._eventListener.loadTimeCollector);document.attachEvent("onmousemove",this._eventListener.mouseCollector);document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,
!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(a,b){this._callbacks[a][this._callbackI++]=
b},removeEventListener:function(a,b){var c,d=this._callbacks[a],e=[];for(f in d)d.hasOwnProperty(f)&&d[f]===b&&e.push(f);for(c=0;c<e.length;c++){var f=e[c];delete d[f]}},_bind:function(a){var b=this;return function(){a.apply(b,arguments)}},_gen4words:function(){for(var a=0;4>a&&(this._counter[a]=this._counter[a]+1|0,!this._counter[a]);a++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words());this._cipher=new sjclcrp.cipher.aes(this._key)},
_reseed:function(a){this._key=sjclcrp.hash.sha256.hash(this._key.concat(a));this._cipher=new sjclcrp.cipher.aes(this._key);for(a=0;4>a&&(this._counter[a]=this._counter[a]+1|0,!this._counter[a]);a++);},_reseedFromPools:function(a){var b,c=[],d=0;this._nextReseed=c[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED;for(b=0;16>b;b++)c.push(4294967296*Math.random()|0);for(b=0;b<this._pools.length&&(c=c.concat(this._pools[b].finalize()),d+=this._poolEntropy[b],this._poolEntropy[b]=0,a||!(this._reseedCount&
1<<b));b++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new sjclcrp.hash.sha256),this._poolEntropy.push(0));this._poolStrength-=d;d>this._strength&&(this._strength=d);this._reseedCount++;this._reseed(c)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(a){try{var b=a.x||a.clientX||a.offsetX||0;var c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&sjclcrp.random.addEntropy([b,c],2,"mouse");this._addCurrentTimeToEntropy(0)},_touchCollector:function(a){a=
a.touches[0]||a.changedTouches[0];sjclcrp.random.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(a){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?sjclcrp.random.addEntropy(window.performance.now(),a,"loadtime"):sjclcrp.random.addEntropy((new Date).valueOf(),a,"loadtime")},_accelerometerCollector:function(a){a=
a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"==typeof b&&sjclcrp.random.addEntropy(b,1,"accelerometer")}a&&sjclcrp.random.addEntropy(a,2,"accelerometer");this._addCurrentTimeToEntropy(0)},_fireEvent:function(a,b){var c,d=sjclcrp.random._callbacks[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}};sjclcrp.random=new sjclcrp.prng(6);
(function(){try{var a,b,c;if(c="undefined"!=typeof module&&module.exports){try{var d=require("crypto")}catch(f){d=null}c=a=d}if(c&&a.randomBytes){var e=a.randomBytes(128);e=new Uint32Array((new Uint8Array(e)).buffer);sjclcrp.random.addEntropy(e,1024,"crypto.randomBytes")}else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(b=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(b);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;
window.msCrypto.getRandomValues(b)}sjclcrp.random.addEntropy(b,1024,"crypto.getRandomValues")}}catch(f){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(f))}})();var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(canary&16777215);function BigInteger(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}
function nbi(){return new BigInteger(null)}function am1(a,b,c,d,e,f){for(;0<=--f;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864);c[d++]=g&67108863}return e}function am2(a,b,c,d,e,f){var g=b&32767;for(b>>=15;0<=--f;){var h=this[a]&32767,k=this[a++]>>15,l=b*h+k*g;h=g*h+((l&32767)<<15)+c[d]+(e&1073741823);e=(h>>>30)+(l>>>15)+b*k+(e>>>30);c[d++]=h&1073741823}return e}
function am3(a,b,c,d,e,f){var g=b&16383;for(b>>=14;0<=--f;){var h=this[a]&16383,k=this[a++]>>14,l=b*h+k*g;h=g*h+((l&16383)<<14)+c[d]+e;e=(h>>28)+(l>>14)+b*k;c[d++]=h&268435455}return e}j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28);BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;
var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr,vv;rr=48;for(vv=0;9>=vv;++vv)BI_RC[rr++]=vv;rr=97;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;rr=65;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;function int2char(a){return BI_RM.charAt(a)}function intAt(a,b){var c=BI_RC[a.charCodeAt(b)];return null==c?-1:c}
function bnpCopyTo(a){for(var b=this.t-1;0<=b;--b)a[b]=this[b];a.t=this.t;a.s=this.s}function bnpFromInt(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0}function nbv(a){var b=nbi();b.fromInt(a);return b}
function bnpFromString(a,b){if(16==b)var c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else if(4==b)c=2;else{this.fromRadix(a,b);return}this.s=this.t=0;for(var d=a.length,e=!1,f=0;0<=--d;){var g=8==c?a[d]&255:intAt(a,d);0>g?"-"==a.charAt(d)&&(e=!0):(e=!1,0==f?this[this.t++]=g:f+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this[this.t++]=g>>this.DB-f):this[this.t-1]|=g<<f,f+=c,f>=this.DB&&(f-=this.DB))}8==c&&0!=(a[0]&128)&&(this.s=-1,0<f&&(this[this.t-1]|=(1<<this.DB-
f)-1<<f));this.clamp();e&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t}
function bnToString(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var b=(1<<a)-1,c,d=!1,e="",f=this.t,g=this.DB-f*this.DB%a;if(0<f--)for(g<this.DB&&0<(c=this[f]>>g)&&(d=!0,e=int2char(c));0<=f;)g<a?(c=(this[f]&(1<<g)-1)<<a-g,c|=this[--f]>>(g+=this.DB-a)):(c=this[f]>>(g-=a)&b,0>=g&&(g+=this.DB,--f)),0<c&&(d=!0),d&&(e+=int2char(c));return d?e:"0"}
function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;b=c-a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--c;)if(0!=(b=this[c]-a[c]))return b;return 0}function nbits(a){var b=1,c;0!=(c=a>>>16)&&(a=c,b+=16);0!=(c=a>>8)&&(a=c,b+=8);0!=(c=a>>4)&&(a=c,b+=4);0!=(c=a>>2)&&(a=c,b+=2);0!=a>>1&&(b+=1);return b}
function bnBitLength(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(a,b){var c;for(c=this.t-1;0<=c;--c)b[c+a]=this[c];for(c=a-1;0<=c;--c)b[c]=0;b.t=this.t+a;b.s=this.s}function bnpDRShiftTo(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0);b.s=this.s}
function bnpLShiftTo(a,b){var c=a%this.DB,d=this.DB-c,e=(1<<d)-1,f=Math.floor(a/this.DB),g=this.s<<c&this.DM,h;for(h=this.t-1;0<=h;--h)b[h+f+1]=this[h]>>d|g,g=(this[h]&e)<<c;for(h=f-1;0<=h;--h)b[h]=0;b[f]=g;b.t=this.t+f+1;b.s=this.s;b.clamp()}
function bnpRShiftTo(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;0<d&&(b[this.t-c-1]|=(this.s&f)<<e);b.t=this.t-c;b.clamp()}}
function bnpSubTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0;-1>d?b[c++]=this.DV+d:0<d&&(b[c++]=d);b.t=c;b.clamp()}
function bnpMultiplyTo(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;0<=--e;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0;b.clamp();this.s!=a.s&&BigInteger.ZERO.subTo(b,b)}function bnpSquareTo(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}0<a.t&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1));a.s=0;a.clamp()}
function bnpDivRemTo(a,b,c){var d=a.abs();if(!(0>=d.t)){var e=this.abs();if(e.t<d.t)null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);else{null==c&&(c=nbi());var f=nbi(),g=this.s;a=a.s;var h=this.DB-nbits(d[d.t-1]);0<h?(d.lShiftTo(h,f),e.lShiftTo(h,c)):(d.copyTo(f),e.copyTo(c));d=f.t;e=f[d-1];if(0!=e){var k=e*(1<<this.F1)+(1<d?f[d-2]>>this.F2:0),l=this.FV/k;k=(1<<this.F1)/k;var r=1<<this.F2,q=c.t,m=q-d,n=null==b?nbi():b;f.dlShiftTo(m,n);0<=c.compareTo(n)&&(c[c.t++]=1,c.subTo(n,c));BigInteger.ONE.dlShiftTo(d,
n);for(n.subTo(f,f);f.t<d;)f[f.t++]=0;for(;0<=--m;){var p=c[--q]==e?this.DM:Math.floor(c[q]*l+(c[q-1]+r)*k);if((c[q]+=f.am(0,p,c,m,0,d))<p)for(f.dlShiftTo(m,n),c.subTo(n,c);c[q]<--p;)c.subTo(n,c)}null!=b&&(c.drShiftTo(d,b),g!=a&&BigInteger.ZERO.subTo(b,b));c.t=d;c.clamp();0<h&&c.rShiftTo(h,c);0>g&&BigInteger.ZERO.subTo(c,c)}}}}function bnMod(a){var b=nbi();this.abs().divRemTo(a,null,b);0>this.s&&0<b.compareTo(BigInteger.ZERO)&&a.subTo(b,b);return b}function Classic(a){this.m=a}
function cConvert(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}function cSqrTo(a,b){a.squareTo(b);this.reduce(b)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;
function bnpInvDigit(){if(1>this.t)return 0;var a=this[0];if(0==(a&1))return 0;var b=a&3;b=b*(2-(a&15)*b)&15;b=b*(2-(a&255)*b)&255;b=b*(2-((a&65535)*b&65535))&65535;b=b*(2-a*b%this.DV)%this.DV;return 0<b?this.DV-b:-b}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}
function montConvert(a){var b=nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);0>a.s&&0<b.compareTo(BigInteger.ZERO)&&this.m.subTo(b,b);return b}function montRevert(a){var b=nbi();a.copyTo(b);this.reduce(b);return b}
function montReduce(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a[b]&32767,d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;c=b+this.m.t;for(a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)}function montSqrTo(a,b){a.squareTo(b);this.reduce(b)}function montMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}Montgomery.prototype.convert=montConvert;
Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==(0<this.t?this[0]&1:this.s)}function bnpExp(a,b){if(4294967295<a||1>a)return BigInteger.ONE;var c=nbi(),d=nbi(),e=b.convert(this),f=nbits(a)-1;for(e.copyTo(c);0<=--f;)if(b.sqrTo(c,d),0<(a&1<<f))b.mulTo(d,e,c);else{var g=c;c=d;d=g}return b.revert(c)}
function bnModPowInt(a,b){var c=256>a||b.isEven()?new Classic(b):new Montgomery(b);return this.exp(a,c)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;
BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;
BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function parseBigInt(a,b){return new BigInteger(a,b)}function linebrk(a,b){for(var c="",d=0;d+b<a.length;)c+=a.substring(d,d+b)+"\n",d+=b;return c+a.substring(d,a.length)}function byte2Hex(a){return 16>a?"0"+a.toString(16):a.toString(16)}
function pkcs1pad2(a,b){if(b<a.length+11)return alert("Message too long for RSA"),null;for(var c=[],d=a.length-1;0<=d&&0<b;){var e=a.charCodeAt(d--);128>e?c[--b]=e:127<e&&2048>e?(c[--b]=e&63|128,c[--b]=e>>6|192):(c[--b]=e&63|128,c[--b]=e>>6&63|128,c[--b]=e>>12|224)}c[--b]=0;d=new SecureRandom;for(e=[];2<b;){for(e[0]=0;0==e[0];)d.nextBytes(e);c[--b]=e[0]}c[--b]=2;c[--b]=0;return new BigInteger(c)}function RSAKey(){this.n=null;this.e=0;this.coeff=this.dmq1=this.dmp1=this.q=this.p=this.d=null}
function RSASetPublic(a,b){null!=a&&null!=b&&0<a.length&&0<b.length?(this.n=parseBigInt(a,16),this.e=parseInt(b,16)):alert("Invalid RSA public key")}function RSADoPublic(a){return a.modPowInt(this.e,this.n)}function RSAEncrypt(a){a=pkcs1pad2(a,this.n.bitLength()+7>>3);if(null==a)return null;a=this.doPublic(a);if(null==a)return null;a=a.toString(16);return 0==(a.length&1)?a:"0"+a}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;
function desP32(a,b,c){var d,e,f,g=0,h=0,k=a[0],l=a[1];for(d=0;32>d;d++)g=32<b[d]?d+1<b[d]-32?(g|l<<b[d]-32-d-1&2147483648>>>d)>>>0:(g|l>>>d+1-(b[d]-32)&2147483648>>>d)>>>0:(e=b[d])>d+1?(g|k<<e-(d+1)&2147483648>>>d)>>>0:(g|k>>>d+1-e&2147483648>>>d)>>>0;for(f=0;f<c-32;f++,d++)h=32<b[d]?f+1<b[d]-32?(h|l<<b[d]-32-f-1&2147483648>>>f)>>>0:(h|l>>>f+1-(b[d]-32)&2147483648>>>f)>>>0:(e=b[d])>f+1?(h|k<<e-(f+1)&2147483648>>>f)>>>0:(h|k>>>f+1-e&2147483648>>>f)>>>0;a[0]=g;a[1]=h;return a}
function desIP(a){return desP32(a,[58,50,42,34,26,18,10,2,60,52,44,36,28,20,12,4,62,54,46,38,30,22,14,6,64,56,48,40,32,24,16,8,57,49,41,33,25,17,9,1,59,51,43,35,27,19,11,3,61,53,45,37,29,21,13,5,63,55,47,39,31,23,15,7],64)}function desInverseIP(a){return desP32(a,[40,8,48,16,56,24,64,32,39,7,47,15,55,23,63,31,38,6,46,14,54,22,62,30,37,5,45,13,53,21,61,29,36,4,44,12,52,20,60,28,35,3,43,11,51,19,59,27,34,2,42,10,50,18,58,26,33,1,41,9,49,17,57,25],64)}
function desPC1(a){desP32(a,[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],56);a[1]=(a[0]<<24&251658240|a[1]>>>8)>>>0;a[0]>>>=4;return a}function desLeftShift(a,b){a[0]=(a[0]<<b&268435455|a[0]>>>28-b)>>>0;a[1]=(a[1]<<b&268435455|a[1]>>>28-b)>>>0;return a}
function desPC2(a){a[0]=(a[0]<<4|a[1]>>>24&15)>>>0;a[1]=a[1]<<8>>>0;return desP32(a,[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],48)}
function desF(a,b){var c=[0,0],d=[0,0];c[0]=a;c[1]=0;desP32(c,[32,1,2,3,4,5,4,5,6,7,8,9,8,9,10,11,12,13,12,13,14,15,16,17,16,17,18,19,20,21,20,21,22,23,24,25,24,25,26,27,28,29,28,29,30,31,32,1],48);var e=c[0]^b[0],f=c[1]^b[1];c=[[14,4,13,1,2,15,11,8,3,10,6,12,5,9,0,7],[0,15,7,4,14,2,13,1,10,6,12,11,9,5,3,8],[4,1,14,8,13,6,2,11,15,12,9,7,3,10,5,0],[15,12,8,2,4,9,1,7,5,11,3,14,10,0,6,13]][e>>>30&2|e>>>26&1][e>>>27&15]<<28>>>0;c|=[[15,1,8,14,6,11,3,4,9,7,2,13,12,0,5,10],[3,13,4,7,15,2,8,14,12,0,1,10,
6,9,11,5],[0,14,7,11,10,4,13,1,5,8,12,6,9,3,2,15],[13,8,10,1,3,15,4,2,11,6,7,12,0,5,14,9]][e>>>24&2|e>>>20&1][e>>>21&15]<<24>>>0;c|=[[10,0,9,14,6,3,15,5,1,13,12,7,11,4,2,8],[13,7,0,9,3,4,6,10,2,8,5,14,12,11,15,1],[13,6,4,9,8,15,3,0,11,1,2,12,5,10,14,7],[1,10,13,0,6,9,8,7,4,15,14,3,11,5,2,12]][e>>>18&2|e>>>14&1][e>>>15&15]<<20>>>0;c|=[[7,13,14,3,0,6,9,10,1,2,8,5,11,12,4,15],[13,8,11,5,6,15,0,3,4,7,2,12,1,10,14,9],[10,6,9,0,12,11,7,13,15,1,3,14,5,2,8,4],[3,15,0,6,10,1,13,8,9,4,5,11,12,7,2,14]][e>>>
12&2|e>>>8&1][e>>>9&15]<<16>>>0;c|=[[2,12,4,1,7,10,11,6,8,5,3,15,13,0,14,9],[14,11,2,12,4,7,13,1,5,0,15,10,3,9,8,6],[4,2,1,11,10,13,7,8,15,9,12,5,6,3,0,14],[11,8,12,7,1,14,2,13,6,15,0,9,10,4,5,3]][e>>>6&2|e>>>2&1][e>>>3&15]<<12>>>0;c|=[[12,1,10,15,9,2,6,8,0,13,3,4,14,7,5,11],[10,15,4,2,7,12,9,5,6,1,13,14,0,11,3,8],[9,14,15,5,2,8,12,3,7,0,4,10,1,13,11,6],[4,3,2,12,9,5,15,10,11,14,1,7,6,0,8,13]][e&2|f>>>28&1][(e<<3>>>0&8|f>>>29&7)&15]<<8>>>0;c|=[[4,11,2,14,15,0,8,13,3,12,9,7,5,10,6,1],[13,0,11,7,4,
9,1,10,14,3,5,12,2,15,8,6],[1,4,11,13,12,3,7,14,10,15,6,8,0,5,9,2],[6,11,13,8,1,4,10,7,9,5,0,15,14,2,3,12]][f>>>26&2|f>>>22&1][f>>>23&15]<<4>>>0;c|=[[13,2,8,4,6,15,11,1,10,9,3,14,5,0,12,7],[1,15,13,8,10,3,7,4,12,5,6,11,0,14,9,2],[7,11,4,1,9,12,14,2,0,6,10,13,15,3,5,8],[2,1,14,7,4,10,8,13,15,12,9,0,3,5,6,11]][f>>>20&2|f>>>16&1][f>>>17&15]>>>0;d[0]=c;d[1]=0;desP32(d,[16,7,20,21,29,12,28,17,1,15,23,26,5,18,31,10,2,8,24,14,32,27,3,9,19,13,30,6,22,11,4,25],32);return d[0]}
function desSwap(a){var b=a[0];a[0]=a[1];a[1]=b;return a}
function des(a,b,c){var d=[0,0],e=[0,0],f=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]];e[0]=b[0]>>>0;e[1]=b[1]>>>0;desPC1(e);for(b=0;16>b;b++)desLeftShift(e,2>b||8==b||15==b?1:2),f[b][0]=e[0],f[b][1]=e[1],desPC2(f[b]);d[0]=a[0]>>>0;d[1]=a[1]>>>0;desIP(d);for(b=0;15>b;b++)a=0==c?f[b]:f[15-b],d[0]=(d[0]^desF(d[1],a))>>>0,desSwap(d);a=0==c?f[15]:f[0];d[0]=(d[0]^desF(d[1],a))>>>0;desInverseIP(d);return d}
function desede(a,b,c){var d,e=a,f=b.length;for(d=a=0;3>a;++a,d+=2,c=!c)e=des(e,b.slice(d%f),c);return e}function getCryptoMod(){try{return require("crypto")}catch(a){return null}}function isGenRandSupported(){var a=0;if("undefined"!==typeof module&&module.exports&&(crypt=getCryptoMod())&&crypt.randomBytes||"undefined"!==typeof window&&"undefined"!==typeof Uint32Array&&(window.crypto&&window.crypto.getRandomValues||window.msCrypto&&window.msCrypto.getRandomValues))a=1;return a}
function collectTime(){return(new Date).getTime()*Math.random()}function collectPerformance(){return performance.now()}var minPool=100,pool=new sjclcrp.hash.sha512,poolIdx=0,mx=0,my=0,mt=0,ku=0,kd=0,pf,randStat=0,paranoiaLevel=0,collectorStat=0,msgErro="Erro processamento!";function RANExc(a,b,c){this.codRet=a;this.msgUsr=b;this.srcExc="undefined"==typeof c?"":c;this.toString=function(){return"RAN"+this.codRet+" - "+b}}
isGenRandSupported()||(sjclcrp.random.startCollectors(),pf="undefined"!==typeof window.performance&&"undefined"!==typeof window.performance.now?collectPerformance:collectTime,addToPool("st"+pf()),window.addEventListener?(window.addEventListener("load",getLoad,!1),window.addEventListener("keyup",getKeys,!1),window.addEventListener("keydown",getKeys,!1),window.addEventListener("mousemove",getMouse,!1),window.addEventListener("mousedown",getMouse,!1),window.addEventListener("mouseup",getMouse,!1),window.addEventListener("devicemotion",
getAccelerometer,!1),window.addEventListener("touchmove",getTouchMove,!1)):document.attachEvent&&(document.attachEvent("keydown",getKeys),document.attachEvent("keyup",getKeys),document.attachEvent("onmousemove",getMouse),document.attachEvent("onmouseup",getMouse),document.attachEvent("onmousedown",getMouse)),collectorStat=1);function run(){addToPool("ld"+pf())}function getKeys(a){var b=["kb","",""];b[1]=a.type;b[2]=pf();addToPool(b.join())}function getLoad(){addToPool("lt"+pf())}
function getMouse(a){var b=["mx","",""],c=["my","",""],d=["mt","",""];b[2]=a.x||a.clientX||a.offsetX||0;c[2]=a.y||a.clientY||a.offsetY||0;d[2]=pf();b[1]=c[1]=d[1]=a.type;addToPool(b.join());addToPool(c.join());addToPool(d.join())}
function getAccelerometer(a){var b=["ac","",""],c=["or","",""];a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;window.orientation&&(c[1]=window.orientation,c[2]=pf(),addToPool(c.join()));a&&(b[1]=a,b[2]=pf(),addToPool(b.join()))}
function getTouchMove(){var a=["tc","",""],b=["tx","",""],c=["ty","",""];a[1]=ev.touches[0]||ev.changedTouches[0];b[1]=touch.pageX||touch.clientX;c[1]=touch.pageY||touch.clientY;a[2]=pf();addToPool(a.join());b[2]=pf();addToPool(b.join());c[2]=pf();addToPool(c.join())}function addToPool(a){pool.update(poolIdx+a);++poolIdx;return 1}
function rndCX(a){var b;if(0==collectorStat)throw new RANExc(200,msgErro,"");addToPool("rand"+pf());for(b=poolIdx;b<minPool;b++)addToPool(Math.random());pool.update(pf());b=pool.finalize();if(1>a||a>b.length)throw new RANExc(201,msgErro,"");pool.reset();pool.update(sjclcrp.codec.hex.fromBits(b));return b}
function rndMod(a,b){"object"!==typeof a&&(a=new sjclcrp.bn(a));for(var c,d,e=a.limbs.length,f=a.limbs[e-1]+1,g=new sjclcrp.bn;;){do c=rndCX(e),0>c[e-1]&&(c[e-1]+=4294967296);while(Math.floor(c[e-1]/f)===Math.floor(4294967296/f));c[e-1]%=f;for(d=0;d<e-1;d++)c[d]&=a.radixMask;g.limbs=c;if(!g.greaterEquals(a))return g}}
function getRand(a,b){if(isGenRandSupported())var c=sjclcrp.bn.random(a,b);else{for(;0<b&&1!=sjclcrp.random.getProgress(b);)--b;1>b?(c=rndMod,randStat=1):(c=sjclcrp.bn.random,randStat=2);c=c(a,b)}paranoiaLevel=b;return c}function curveParameters(a,b,c,d){this.curve=b;this.x=c;this.y=d;this.partUIdentification=a}
function gcrv(a){var b=a.toUpperCase().split(",");if(4>b.length)throw new RANExc(400,"Tam dados publicos invalido: "+b.length);var c=b[0];a=b[1];var d=b[2];b=b[3];if(!a.match("[0-9A-Fa-f]+"))throw new RANExc(401,"Chave publica invalida");if(isNaN(d))throw new RANExc(402,"Indice de chave nao numerico");if(1>d||13<d)throw new RANExc(403,"Indice pk invalido");if(!b.match("[0-9A-Fa-f]+"))throw new RANExc(404,"Erro assinatura");if(0==a.indexOf("3056301006072A8648CE3D020106052B8104000A03420004")){if(176>
a.length)throw new RANExc(405,"Tam dados publicos invalidos");c=new curveParameters(c,sjclcrp.ecc.curves.k256,a.slice(48,112),a.slice(112,176))}else if(0==a.indexOf("3059301306072A8648CE3D020106082A8648CE3D03010703420004")){if(182>a.length)throw new RANExc(406,"Tam dados publicos invalidos");c=new curveParameters(c,sjclcrp.ecc.curves.c256,a.slice(54,118),a.slice(118,182))}else if(0==a.indexOf("3076301006072A8648CE3D020106052B8104002203620004")){if(240>a.length)throw new RANExc(407,"Tam dados publicos invalidos");
c=new curveParameters(c,sjclcrp.ecc.curves.c384,a.slice(48,144),a.slice(144,240))}else if(0==a.indexOf("304E301006072A8648CE3D020106052B81040021033A0004")){if(160>a.length)throw new RANExc(408,"Tam dados publicos invalidos");c=new curveParameters(c,sjclcrp.ecc.curves.c224,a.slice(48,104),a.slice(104,160))}else if(0==a.indexOf("3049301306072A8648CE3D020106082A8648CE3D03010103320004")){if(150>a.length)throw new RANExc(409,"Tam dados publicos invalidos");c=new curveParameters(c,sjclcrp.ecc.curves.c192,
a.slice(54,102),a.slice(102,150))}else throw new RANExc(410,"Algoritmo invalido");if(!isValidSignature(a,d,b))throw new RANExc(411,"Assinatura invalida");return c}
function isValidSignature(a,b,c){c=new BigInteger(c,16);var d=new RSAKey;d.setPublic("D338E6663C9247057409157D343D47D38F9240A4C0D4706C810D2B4862E8F9583ECD9CE62A25A1D509ED088705741C9CBCB042E0EDFB175CD0213BBDA8804B91DC78805C9D32FDEDF2A7EE55ADBF96B973334ED9E51ECCE49495AECF2BD035A3A24B705C980ED2C0BB0DD26560688B5ABD4B26EBEA9F790151069795EB1220CC5A9F4514104B7C3E9A819BB98846899C9A4A13A424C19EA5D6B2ACF66B5C75FF85158A04094281CDB4D293CDFAA261EFE552281880492439D6EF0D75D19ABEE5A294254482207808F77BBD4D75D68F1C78F8582E4D3A62EE7E5A968A7248348677AAAE5CC5E2A8D3694D59209CE469A0C0395A7172D75208274B9BC238497AC5 BF0008C5D6E525FEA643C5E96CE476672DD746DEBA07A3BDBD9FF2CCCC0D67E75A776C672F54B76A3AAB11D9A4D39B855F377FB9E86CC12704F40807D52D7C6A19961369D9068E629ACAAD226FA13D7CB848E8CD6BDE153B6676A3EED1DCD68AB7399ED8551C11E5F01C92E307B7879ADC3B3028136C3FD4C81BFA76A1A1B50CD9AEAA849F0F815E5D3C1EE865CE165201C609F8F87D623077B17F8BFBA9AC7B14E6281F14104894D38CA17910E0A7184BA5E0632961076C4A8EE9BC55093EAE8147DF804CAC7A2BF7200FD52EAA3C75D363F4B8C9F122692E31C9CA244029B5D4B3914B5737032DD4F63C092AD8FFE0924E9C07BBE792BFCF6E0EE2C557FED5 DCF6DA6FA52DDE74A50D1C894B93F2617BC4D565FE1C53BCC6D915B4849D6C599190DD8A70DF3643017F5125E5D81C9707654F9DAD231B0F5FBDB46A53DA4D3B584E0572D0D08A900DF12B12D791DDAAD4A273C0E19ECCC5CF8973C10C08EAF7EE54BD50BE7B27175C9E3418B1B847B71AF6C805495DBCFF6DE409A2B6EA4648417BB096809D2BE06D0D5137D1A29B8FCC50E24FA9F1940CFE0C37247C862970099F97EB3AE25BBE10A28881DB81773F4ECAF6A04035255B142BC74FC7F95848805D0B263D1EE720A4B424A578951E33122B6C368BE0F58FBD8A4866096060CD519114A6536374EB5AF1891DFA2A17B1FF4CE1F2A7D784847BF6F04BCEDA578D CE7D6D729CC32A0489C63BC2F8EC6B54FDFC09F417776082B95D948BA576056E6A1858F246E8E12DFE5D4B4E32076A42A9744FA9DD6C2F8AD56383AC56601924FE90A4FD5C8375E92925A82D8831BB4514732A5DDAEF5C00E013A2AFD74D370F647CC6C987FA7AF564C497B478C7DA418E533C6CC1CC44A64E2DB42939A69188D82404A229025596981D5B60DA2F5994187D3ED334CD6E49718721E2C2A437B13D312A70AAEFAD49CEC8825ACE07AB8E8E3273787A7F6D0E145A96D3AEE87456228D359C3A4FB60A3174BE98FA64330AF8FBC53B82CA6617E9C519AA68D78C301793367AD7CF247F1CC6B0B9A5C64223211A31A09C7307D47008F49D7BFEFBE3 F015DF98DC68A7939F4072A41859A96163BA6D432DF2F9CE5B83D44B0A6E7ABD4CC4DF89285698EDC6660217A697FAA4F9BFA4272C3F3811FCC798685FD17773195FC4C7F3ADDB52C7AD448FED7FBE3F956253030342D155E064C9AFB83EAC47E6994FC4207C7B36B45A958BDEC3BB1E3B2DB3E7D09295B2951940CE82E0C37429808E7A69A9A4B54832078FC2BEAA002AE7C00087D4A891F6327CE4951880FF43877D6F7643A61322EBECCFA0DAACBFF80E7B2E4931129087AEA34D5AC781D8E8DA2E321215A5C4E40B950D590A2D54E8012C8507F19F4D908CAE6484102F8D364DD571C47E2F8760131877B0B65EC59A379C7C1A9546295989FD0CEC9AE6DD BA8348020E8ECAF5C35785046E1C11A02BBA5AF4573BBCC14020B3CA1CC41A8A3B1634E3896C20D6B643DC8F4E57632841C71C41F9319B51F9752FC845732706CED5532CCBE4068EA44A366211BB9A98A14B611840EBAE6CAB2E5B5C1D21C7D208DC4570305869CC6C50867EECE8A511972B7B3D3918CC4C4F5C2D65A38795A5A195F52BA2B46247FC228767258F012801DD5C0C3DA8BD3C9F7B3247D88572E97D6F31897BF9B12B91B869EF9EB69EF7F4F35DBF857EBEF3A61F41F7F449FCBF65CD85313B14CDF7FF7C654A99D5E520EFADEB9456547DAE64E0F359D9916CECA6FFBA86BF020CFC254279F43C2D603A94D06356B7A12FE7723C9537B8885D89297BFAF9A915E674FF547E7D2F62E560598F13600852B8838E17B28197A3C4192E02D9D4410A24B88279F0192CB38BC2954A6F30F6FC8F56B26D19870001557FDF23047E0257665DBC3AD3836BB92564E127A6D337C7CCF40512E50C5BE9D85F4E13117127953F19C41BE1ADACEA9D93DBA61D7BE0AFD44ED3532AD8C5531CD4645D3F5763E96AA4540F2575313979E4A924103F6670452D4916087D170F7E3A0622DDC6DF352F8B81B056BF59C037D2ACBB2942423835B6EB008C9F5360FA975BA634E752649EEE5D23055BFDD35459D10FA46CBAC3FE6EC5E0BA1DAAB3EA9CBB75B4A2CE44361B6FFEA36752FAB3738CAE9EA1B1C38FC434BB016F60951981 BDD6CF240134F903B0705CC8101A1572CDD1FB38A1A53D22A7F74797B6B3776F157374A5F0308A901E82F54F4B22C886BA7D796776B87D21441D2CD2001CF756586103D5770DA02B739D595322BA0B95FE4B121904A7B65DDA35716DA2CEC7180DA17F42D8F9EBCFD26FB81B7070862BBA79615B7B67DBD3C9DCDB6AD98EE44A9CF27E6C04616A1B469DE2B10464A19D8FC5BD8B7F69AF8A82806016364B16D3D70007714A74DD245A8B48FAA80ADAB1CE670A71FB61F320D766C432997FD74F688D8B4EEA4F7AD901CD253E26ED128C3DF843676C51CE86C345ED3F46D46344159EA0891061BA995761C8EEE5AE3911B4865F69EDE5DB16F3A42C099CDD300624F2651E6550EF1B566D2F5EB3D1BE67634262FA99FC574435865A2DDFB695FA67CBFE7651F7763CBEEA3E21A63662C0AECC1937B15568C62FBA8324978AD1A2EDDDD805EB2839CF3DC1CD03E31605ED46FFEFA9401612F63AD44EA24776AD269CCE45848767A76DDAEA45B506778743AB7E6C8FFA5B4B04F0754194C60CAE98F847A30F471E08DEF54568556E23C8DE2A7410A6D0D2E581CD5554D26663F8AFB500940B8188AE599220084F162A8222026ADBBBFE7101CD3B8094C38A735F8A6E69D7BD982646F7BBC6AAA9CBF7445C17CB16D8BED7C947FBFC09B5EE1BFEDFF810373BD1C14F699CB480164652FEAC99C26B6805B9D9B4AC10052864BBD13F C857DF0C85ECC00FF584B31D8CC235D6CDF9048875166DB6FC15E3981452E7ED8E8B11BD71C735FFD36DC0FEBDD25FA7ECA40C650523ED4C21BBCCF14F6020C5B6FB98B8E0F56D76045FEC8E86B07C676DFCD5FE86ABFB34747C3155B0B5AE10D43B441C9AE2CBDA349A1BD7593B3A14A26C5D51CE986959773221C25C0DD841A8CBFF82F8AD4F60352A864C363D87B883CA7144CD521898BE07142CB7AE0436FA5894971F4A24BF4CEBCB52B3FC461A1DC13CCECE840C2819B066CB8B4E9EE1C6C310FE4477568447EF484B1490A3AE539093797452D6212433758CDA0594A775EB02A598BBB3A831476EA25BD2073149B46CD7F3C2D3C3B243EEE5A238AC887340294E368D7D301F2F9E48F48FCA2CA1E70E07E4C976D6C3D065F578F30D3A273DE8F7927474E4F6B293EEB36018E2E5073D860A2E006AEF43A0C0BB03ECB757FC6C2FCACBF7F851522A25711E0F8E6C98FC3ACFA7A79625EBC6DE3A4446D53D52DD52E7E27D3F35A1D98ACAA0CEF622A093624B0BDC99519627022E9D80A2ACD1F57D6D2E81B75B37EEAEAEB46C4491F34CE0EB6D0B50DFBD285776DB9721C6A304A96072DF368CEDD949C05BA5BF1BB229602B4D77C067EC5FE339C3641BB0E190573C1F6FA00E84BF89DAB1BEB4417B0D99C34E3C9AD61974A68F308F93450ACCEB77D63891FF22399F72974D00E4FB185ED4D18F5D237F5CFAF62FA7A7 BAF063861FF321B2C1559513EEA708BF72A3A40F7533C39B45560BF60D48E8B66E698A4A70A0A712EBF7552FEE9247EFCDDEC945D884F8C7A6AFA0D0161D16DB1CAAE9B2983172512DF5A28746FE3587BF699AABA7708BEE1F6792D669562BC8212110FBEA1DF6E7248936983744BC16EDFAC99A3B7B5479E6AC01E86777182FD41C414466FB12C5DAB560E24C31DA5BAD65A4930E47299C88D02E0C9BFF6A4CE306E4480EA1C41082D0F84F970E61A0CDEA8B55D2051D621EB85673E83205CC8CC3AF24CBC408CBAC6BF38999FF13CF15F1B5DB2558D01E7A874C0CAA72D6188BC343E41E0DD7BA1D507FD793CFA4F08CACFE7E02759865F20A5019BE2B473250494330D78ED3ACEC5CA8BD0043910077DB016741D5CAAD9F2419A21D36ED9508BCA74E878D855ED87790DF30B3DA4F073E4828EA1CACAA3BACAA62255B76F2E34EF468E510FF082993AA680D11BA538049BC9EEE9A08C67FF617ECE6F8EBC382DCB04FD11CC7BB872F33F7799087E30794AAAFA028FBBF778C6090BBCC118BE7A5A9CDF0DD6C3B31336FAD6E022F371AC0E0F47B88DDF422CB355C81F6E2459C848D5785E7D772E4786C05E90851F4E4A09B23F3D6B1368500585045BD7F2D3A4D73891889A40C2FA4F9972BE83C51C98DC9FBC3FB2EA305B31DCE500095C32857F258C19D4DB078FE0FBAAE7CC0EEB4EED0EE001F100BA45BCF983EE893B7 9B671B8C7FB6CEC278D46C0CB3067177A77AE2FF3EEC74C9F020D95461D7D1152FF1C52E7B5A864A4A9A23331FCAFF6834CD1D61FC8EEB3B94659E44BD86F1111E29CBC9F8B695036B194009BC853EB4DAFD287D364EC414CD03FE6030B7B87A97AA1C5213D0694130E208B8A3DB941E96A9943D54A2FF7513E4D89578A309C23AD4E281B94A14CDB6371A78EF15D24CF7123D8BD27BFDC1E735A1236307FB2C1F53827274E3152A8024BBD1E7F167A84D31F499392C19414A5EEE4F3EB11366B6127298302B9A95CA1970650C649575DDA70704B072960D9EFF0A7F865395D583B33ACDAB8A7DA3198AE3DB33208CE7E5023425642E964EBD959203B379E8A4369C829AA5D19BEDC9A34DCF088F495AA10ACB505A88296C93794E55FB4CD0286775C3D75B1974EB98937FF92249B5B309FBE991B4D47F60050B5BC14E9C15347F3DED69C91B989264192EB6B2037DA50C6DF59417A2B571CD168477171F127E5E5CF632B21AEC6B898581DB7035D158E606BE1BAB97F2B60C1AD5D529BC594EB2D36E584849AB1984F9952B4EB96A874E92BAEAD4D024922A1435823322E57DDC29ABC16D129A3CBE03FC17FBF03EAC66C18C9F924D02CE5BE870F58F0067CAD38C68F5C05F54FB066C050DED76BB77B5FD9802ADC2C49B7400FD5A605C5A1E83F6916F1EA774F2FFA47321F4CBD9B71DF64FC92BF8A56DFFA4EABBEA14AE3D AB8124E2E5189A5BC8179374C8E2437AB04882714FA2860C3DCCE6F52AEF9EE569FEAEE840EB8F5A0A970F37AF9CD6C580BEF649AFE50196770697518D8EEE865F2EFC786EAD9BB2036A1308828215B5289BBDC74AF5797F0D5A80AE0DC37A633AA8C6310B501EC0C02231E3D20619200D25359D65C7744354EFA72E6E7BF51BECA0822C99165978D20724DD0CE3C98382BFCE7EC7D3F5B9340DF7DA1861B9C8FE15B3C746AB4AD012005545B638E83149622C598CFA49E72BB8EDD52373655067393A4BE196F85976D31A50E57896E5C1002401C70B7F76C2759744DAF0DB66155408306377C6F6FEE3D791DC9327F1F61C4B683CA767AEEC1D217B69DDCD9D 90B1EBCB7160BC2EE26763C74C45EF336047409CA74F211EDE72921BA14BAF3DD0AB6EF260255F1240DBBEDD04C2153F9D758ABE8E987D00EE553A8C75C0689E98493DB71A413803A11D664001B7D274C82A11AC45815DBDFF9A2D22CDFA88CD496C1EB91562C1A16A425722521C6BDC6C0B333A88727E78594110A2E098D282ABDAB622CE827B6AACF067D538E46D1165C1B651760408ABB55150DF99B37A6F5C69AC866774792D9C88FDF6429A1970BB757B5956A07EE35856BA54CD134A6A7B62E77FFF32CD25E60F3F29E59795364D9DFCF93AFDBCE65B50AA420FFB1D603525323104F7073674E53250A9DB0606F04E470D2AA9E0975E22CB31EA2ACE113F9982B0B038DC8E5078AE8C92228A73AFC37A4A52645DDD9DF04C47B5CA6CD506CE637C449BF2CD7E9CD09F5FF9061751A9DC81C844D907E760BD7EDADC3DF3ECA97E6943198D31C0AA162CBBDE0FCE745CB13B49B862DAA388211FCE20C7C7DC7CABD3BCF3ED7F7A7CA4D5DDE5A0FD1DB87AB058F725F19958585936C3D2A64FF1B9141F4FAD2DC2E74A03F628FFF139A5D841C5802D780D605ED975BAAA6EE3D73F1D968B7408739240FA88AFF69F4F4E29F84CBDBE94CBFC99344F33A674B26B28A2DDB8EBC63ED4878E4C55CD7B977FC5E26675EE07BFBD1C7950A9DA1AA65F6876848C66DFAE46DC840710FE6BC1494E2D71BBFC98BF079AF3A4B45F05 D2C931D3342AACB19ACC5AC4A446AFC471D522F07A5C7B3E87D5D2259DA06119C9516F719FC259ACC8DB374A1051E46D42B95E3B5A0013777D8DF9E90A7A8C76AAC2B553AED37308944C32797F4933956529776F3D4B9C3305AEC2269E0A6EE70967182E285475B7DC5DA2BE6E8D1AD38CDD214D0E093B3EA467D847A43F5F4C801E14E4C4F70B2DA293295A129400669A77D006666F135874A7BE4394AE6B5593D421EEF687D8B8374F08053703D8D3DC26C294DE14E2DA542F3D7E3E77599021E1F5910883018546C5B887B6BEC75271E7A6713C077687911B48D4D14F7970FFC3661FD785F1847F78FA9C8988298237FD5E008355700E7AE78E4126989DA1".split(" ")[b-1],
"10001");c=d.doPublic(c).toString(16).replace(/^1f+00/,"").toLowerCase();if(0==c.indexOf("3031300d060960864801650304020105000420")){if(102!=c.length)throw new RANExc(500,"Tam sha256 invalido");b=new sjclcrp.hash.sha256;c=leftPad(c).slice(-64)}else if(0==c.indexOf("3051300d060960864801650304020305000440")){if(166!=c.length)throw new RANExc(501,"Tam sha512 invalido");b=new sjclcrp.hash.sha512;c=leftPad(c).slice(-128)}else throw new RANExc(502,"Algoritmo de hash invalido");b.update(sjclcrp.codec.hex.toBits(a));
return leftPad(sjclcrp.codec.hex.fromBits(b.finalize())).toLowerCase()==c}function gsk(a,b){if(4!=a.length)throw new RANExc(300,"Tam mk inv");if(32>b.length)throw new RANExc(301,"Tam wk inv");var c=b.slice(0,32);if(!c.match("[0-9A-Fa-f]+"))throw new RANExc(302,"Wk inv");return(new sjclcrp.cipher.aes(a)).decrypt(sjclcrp.codec.hex.toBits(c))}function cipherRes(a,b,c,d,e,f){this.x=a;this.y=b;this.hmac=c;this.cryptogram=d;this.algorithmId=e;this.partVId=f}
function SharedSecret(a,b,c){this.x=a;this.y=b;this.secret=c}function DerivatedKey(a,b,c,d){this.algorithmId=a;this.partVId=b;this.cipherKey=c;this.macKey=d}function getSharedSecret(a){var b=gcrv(a),c=b.curve,d=getRand(c.r,4);a=c.G.mult(d);b=(new sjclcrp.ecc.point(c,new sjclcrp.bn(b.x),new sjclcrp.bn(b.y))).mult(d);return new SharedSecret(a.x.toString().substring(2),a.y.toString().substring(2),b.x.toBits())}
function kdf(a,b,c){c="01"+c.split(",")[0].toUpperCase()+"RANEC005";var d=new sjclcrp.hash.sha256;d.update([1]);d.update(a);d.update(sjclcrp.codec.utf8String.toBits(c));a=d.finalize();b=gsk(a.slice(0,4),b);a=a.slice(4,8);return new DerivatedKey("01","RANEC005",b,a)}function leftPad(a){1==a.length%2&&(a="0"+a);return a}
function formatISO0PINBlock(a,b){var c=["0",a.length.toString(16),a,"ffffffffff"],d=b.length;d=["0000",b.slice(d-13,d-1)];c=sjclcrp.codec.hex.toBits(c.join("").slice(0,16));d=sjclcrp.codec.hex.toBits(d.join(""));c[0]=(c[0]^d[0])>>>0;c[1]=(c[1]^d[1])>>>0;return c}
function raneccenc(a,b,c){try{if("undefined"==typeof a||"undefined"==typeof b||"undefined"==typeof c)throw new RANExc(100,"Parametros invalidos");if(4>a.length)throw new RANExc(101,"Tamanho de senha inv\u00e1lido","");var d=getSharedSecret(b),e=kdf(d.secret,c,b),f=new sjclcrp.cipher.aes(e.cipherKey),g=sjclcrp.codec.utf8String.toBits(a),h,k,l=sjclcrp.bitArray,r=l.bitLength(g);a=0;b=[];c=[0,0,0,0];if(r&7)throw new RANExc(102,"Tamanho inv\u00e1lido de senha");for(h=0;a+128<=r;h+=4,a+=128){var q=g.slice(h,
h+4);for(k=0;4>k;k++)q[k]^=c[k];c=f.encrypt(q);b=l.concat(b,c)}r=16843009*(16-(r>>3&15));q=l.concat(g,[r,r,r,r]).slice(h,h+4);for(k=0;4>k;k++)q[k]^=c[k];b=l.concat(b,f.encrypt(q));var m=new sjclcrp.misc.hmac(e.macKey),n=new cipherRes(leftPad(d.x),leftPad(d.y),leftPad(sjclcrp.codec.hex.fromBits(m.mac(b))),leftPad(sjclcrp.codec.hex.fromBits(b)),e.algorithmId,e.partVId)}catch(p){window.console&&console.log(p);if(p instanceof RANExc)throw p;if(p instanceof sjclcrp.exception.invalid)throw new RANExc(1,
msgErro,p);if(p instanceof sjclcrp.exception.corrupt)throw new RANExc(2,msgErro,p);if(p instanceof sjclcrp.exception.bug)throw new RANExc(3,msgErro,p);if(p instanceof sjclcrp.exception.notReady)throw new RANExc(4,msgErro,p);throw new RANExc(999,msgErro,p);}return n}
function ecPin(a,b,c,d){try{if("undefined"==typeof a||"undefined"==typeof b||"undefined"==typeof c||"undefined"==typeof d)throw new RANExc(100,"Parametros invalidos");if(!a.match("^[0-9]{4,12}$"))throw new RANExc(600,"Senha deve possuir entre 4 e 12 digitos");if(!b.match("^[0-9]{13,19}$"))throw new RANExc(601,"PAN deve possuir entre 13 e 19 digitos");var e=getSharedSecret(c),f=kdf(e.secret,d,c),g=desede(formatISO0PINBlock(a,b),f.cipherKey,0),h=(new sjclcrp.misc.hmac(f.macKey)).mac(g),k=new cipherRes(leftPad(e.x),
leftPad(e.y),leftPad(sjclcrp.codec.hex.fromBits(h)),leftPad(sjclcrp.codec.hex.fromBits(g)),f.algorithmId,f.partVId)}catch(l){window.console&&console.log(l);if(l instanceof RANExc)throw l;if(l instanceof sjclcrp.exception.invalid)throw new RANExc(1,msgErro,l);if(l instanceof sjclcrp.exception.corrupt)throw new RANExc(2,msgErro,l);if(l instanceof sjclcrp.exception.bug)throw new RANExc(3,msgErro,l);if(l instanceof sjclcrp.exception.notReady)throw new RANExc(4,msgErro,l);throw new RANExc(999,msgErro,
l);}return k}function isInvalidSign(a){var b=a.substr(0,2);return a.match(/([0-9])\1\1/)||b==a.substr(2,2)&&b==a.substr(4,2)||-1!="0123456789".indexOf(a)||-1!="9876543210".indexOf(a)}function isInvalidPin(a){return a.match(/([0-9])\1\1\1/)||-1!="0123456789".indexOf(a)||-1!="9876543210".indexOf(a)}
function ecNewPin(a,b,c,d){if(!a.match("^[0-9]{4}$"))throw new RANExc(700,"Senha deve possuir 4 digitos");if(isInvalidPin(a))throw new RANExc(701,"Senha fora do padrao de seguranca");return ecPin(a,b,c,d)}function ecNewSign(a,b,c,d){if(!a.match("^[0-9]{6}$"))throw new RANExc(700,"Assinatura eletronica deve possuir 6 digitos");if(isInvalidSign(a))throw new RANExc(701,"Assinatura nao atende ao padrao de seguranca");return ecPin(a,b,c,d)};